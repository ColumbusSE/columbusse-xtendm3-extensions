{"programModules":{"CREXTPRT":{"program":"CREXTPRT","triggers":{"SCE_Batch_CREXTPRT_QMS601PF":{"name":"SCE_Batch_CREXTPRT_QMS601PF","method":"extendOutput","advice":"POST","active":true,"modified":1726494587541,"modifiedBy":"FZAHLTEN","sourceUuid":"235ca833-2214-41a5-96ee-3990887be2f0","programName":"CREXTPRT","utilities":[],"type":"METHOD","priority":500,"market":"ALL"}},"transactions":{},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"235ca833-2214-41a5-96ee-3990887be2f0":{"uuid":"235ca833-2214-41a5-96ee-3990887be2f0","updated":1732119674172,"updatedBy":"FZAHLTEN","created":1720689409234,"createdBy":"FZAHLTEN","apiVersion":"0.21","beVersion":"16.0.0.20240916174523.6","language":"GROOVY","codeHash":"6A4EBE5096187B43E0AD53F78B976C9FFC28A261D0821B7FB1C0D5E413695E0B","code":"LyoqIE5hbWU6IENSRVhUUFJULlNDRV9CYXRjaF9DUkVYVFBSVF9RTVM2MDFQRi5ncm9vdnkNCiAqDQogKiBUaGlzIGV4dGVuc2lvbiBpcyB1c2VkIHRvIGFsbG93IGFkZGl0aW9uYWwgb3Igc2VsZWN0ZWQgb3V0cHV0IGRhdGEgZm9yIFFNUzYwMVBGLiBJdCB3aWxsDQogKiBiZSBjYWxsZWQgd2l0aCBSSURJLCBSSUROIGFuZCBJVE5PIGFuZCBzdG9yZSBkYXRhIGluIEVYVDYwMDAgYW5kIEVYVDYwMQ0KICoNCiAqIERhdGUgICAgICAgICBDaGFuZ2VkIEJ5ICAgICAgICAgICAgICAgICAgICAgICAgIERlc2NyaXB0aW9uDQogKiAyMS4wMy4yMDI0ICAgRnJhbmsgWmFobHRlbiAoQ29sdW1idXMpICAgICAgICAgICBjcmVhdGlvbg0KICogMTguMDYuMjAyNCAgIEZyYW5rIFphaGx0ZW4gKENvbHVtYnVzKSAgICAgICAgICAgc2VsZWN0IGFscmVhZHkgZXhpc3RpbmcgZGF0YSBmb3IgZGVsZXRlIHdpdGggcGFydCBrZXkNCiAqIDI4LjA4LjIwMjQgICBGcmFuayBaYWhsdGVuIChDb2x1bWJ1cykgICAgICAgICAgIHVzZSBRTVNPVFMuUVREQ0NEIGZvciB0aGUgY291bnQgb2Ygb3V0cHV0IGRlY2ltYWxzDQogKiAxNy4xMC4yMDI0ICAgRnJhbmsgWmFobHRlbiAoQ29sdW1idXMpICAgICAgICAgICBjaGVjayBTUEVDIGZyb20gUU1TT1RTIHZpYSBRTVNSUVMNCiAqDQogKi8NCmltcG9ydCBqYXZhLnV0aWwuTWFwOw0KaW1wb3J0IE0zLkRCQ29udGFpbmVyOw0KDQppbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7DQppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjsNCmltcG9ydCBqYXZhLnRleHQuRGVjaW1hbEZvcm1hdDsNCg0KcHVibGljIGNsYXNzIFNDRV9CYXRjaF9DUkVYVFBSVF9RTVM2MDFQRiBleHRlbmRzIEV4dGVuZE0zVHJpZ2dlciB7DQoNCglwcml2YXRlIGZpbmFsIE1ldGhvZEFQSSBtZXRob2Q7DQoJcHJpdmF0ZSBmaW5hbCBMb2dnZXJBUEkgbG9nZ2VyOw0KCXByaXZhdGUgZmluYWwgUHJvZ3JhbUFQSSBwcm9ncmFtOw0KCXByaXZhdGUgZmluYWwgRGF0YWJhc2VBUEkgZGF0YWJhc2U7DQoNCg0KCXByaXZhdGUgc3RhdGljIGZpbmFsIERlY2ltYWxGb3JtYXQgZGYxID0gbmV3IERlY2ltYWxGb3JtYXQoIjAuMCIpOw0KCXByaXZhdGUgc3RhdGljIGZpbmFsIERlY2ltYWxGb3JtYXQgZGYyID0gbmV3IERlY2ltYWxGb3JtYXQoIjAuMDAiKTsNCglwcml2YXRlIHN0YXRpYyBmaW5hbCBEZWNpbWFsRm9ybWF0IGRmMyA9IG5ldyBEZWNpbWFsRm9ybWF0KCIwLjAwMCIpOw0KCXByaXZhdGUgc3RhdGljIGZpbmFsIERlY2ltYWxGb3JtYXQgZGY0ID0gbmV3IERlY2ltYWxGb3JtYXQoIjAuMDAwMCIpOw0KCXByaXZhdGUgc3RhdGljIGZpbmFsIERlY2ltYWxGb3JtYXQgZGY1ID0gbmV3IERlY2ltYWxGb3JtYXQoIjAuMDAwMDAiKTsNCglwcml2YXRlIHN0YXRpYyBmaW5hbCBEZWNpbWFsRm9ybWF0IGRmNiA9IG5ldyBEZWNpbWFsRm9ybWF0KCIwLjAwMDAwMCIpOw0KDQoJcHJpdmF0ZSBTdHJpbmcgcHJpbnRlckZpbGUgPSAiIjsNCglwcml2YXRlIFN0cmluZyBqb2JOdW1iZXIgPSAiIjsNCglwcml2YXRlIFN0cmluZyBzdHJ1Y3R1cmUgPSAiIjsNCglwcml2YXRlIGludCB2YXJpYW50ID0gMDsNCglwcml2YXRlIGludCBycGJrICA9IDA7DQoJcHJpdmF0ZSBIYXNoTWFwPFN0cmluZywgT2JqZWN0PiBmaWVsZE1hcDsNCg0KCXByaXZhdGUgU3RyaW5nIGlCYW5vID0gIiI7DQoJcHJpdmF0ZSBTdHJpbmcgaUl0bm8gPSAiIjsNCglwcml2YXRlIFN0cmluZyBpUmlkaSA9ICIiOw0KCXByaXZhdGUgU3RyaW5nIGlSaWRuID0gIiI7DQoNCglwcml2YXRlIGxvbmcgbG9uZ1JpZGkgPSAwbDsNCglwcml2YXRlIGRvdWJsZSByb3VuZGVkUHhudW0gPSAwZDsNCg0KCXByaXZhdGUgU3RyaW5nIG1pdHhCYW5vID0gIiI7DQoJcHJpdmF0ZSBTdHJpbmcgbWl0eEl0bm8gPSAiIjsNCglwcml2YXRlIFN0cmluZyBtaXR4UmlkbiA9ICIiOw0KCXByaXZhdGUgaW50IG1pdHhSaWRsID0gMDsNCglwcml2YXRlIGludCBtaXR4UmlkeCA9IDA7DQoJcHJpdmF0ZSBTdHJpbmcgbWl0eFdobG89ICIiOw0KDQoJcHJpdmF0ZSBTdHJpbmcgcW1zcnFoRmFjaSA9ICIiOw0KCXByaXZhdGUgU3RyaW5nIHFtc3JxaFFyaWQgPSAiIjsNCglwcml2YXRlIGludCBxbXNycWhRc3RhID0gMDsNCg0KCXByaXZhdGUgU3RyaW5nIHFtc290c1F0c3QgPSAiIjsNCglwcml2YXRlIGludCBxbXNvdHNUc3R5ID0gMDsNCglwcml2YXRlIGludCBxbXNvdHNRdGUxID0gMDsNCglwcml2YXRlIGludCBxbXNvdHNRdGUyID0gMDsNCglwcml2YXRlIGludCBxbXNvdHNRc2UxID0gMDsNCglwcml2YXRlIGludCBxbXNvdHNRc2UyID0gMDsNCglwcml2YXRlIGludCBxbXNvdHNEY2NkID0gMDsNCglwcml2YXRlIGRvdWJsZSBxbXNvdHNFdm14ID0gMGQ7DQoJcHJpdmF0ZSBkb3VibGUgcW1zb3RzRXZtbiA9IDBkOw0KDQoJcHJpdmF0ZSBTdHJpbmcgcW1zcnF0UXJpZCA9ICIiOw0KCXByaXZhdGUgU3RyaW5nIHFtc3JxdFF0c3QgPSAiIjsNCglwcml2YXRlIGRvdWJsZSBxbXNycXRTbXN6ID0gMGQ7DQoJcHJpdmF0ZSBkb3VibGUgcW1zcnF0UXRycyA9IDBkOw0KDQoJcHJpdmF0ZSBib29sZWFuIGZvdW5kUW1zcnFzU3BlYyA9IGZhbHNlOw0KCXByaXZhdGUgU3RyaW5nIHFtc3Jxc1NwZWMgPSAiIjsNCg0KCXByaXZhdGUgZG91YmxlIHJlc3VsdFF0cnMgPSAgMGQ7DQoJcHJpdmF0ZSBTdHJpbmcgcmVzdWx0UXRreiA9ICIgIjsNCg0KCXN0YXRpYyBpbnQgYXJyTWF4ID0gMjAwOw0KCXN0YXRpYyBpbnQgY29uc3RUVFlQMzEgPSAzMTsNCglzdGF0aWMgaW50IGNvbnN0Uk9SQzMgPSAzOw0KDQoJcHJpdmF0ZSBTdHJpbmdbXSBhcnJSaWRuID0gbmV3IFN0cmluZyBbYXJyTWF4XTsNCglwcml2YXRlIGludFtdIGFyclJpZGwgPSBuZXcgaW50IFthcnJNYXhdOw0KCXByaXZhdGUgaW50W10gYXJyUmlkeCA9IG5ldyBpbnQgW2Fyck1heF07DQoJcHJpdmF0ZSBTdHJpbmdbXSBhcnJXaGxvID0gbmV3IFN0cmluZyBbYXJyTWF4XTsNCglwcml2YXRlIFN0cmluZ1tdIGFyckl0bm8gPSBuZXcgU3RyaW5nIFthcnJNYXhdOw0KCXByaXZhdGUgU3RyaW5nW10gYXJyQmFubyA9IG5ldyBTdHJpbmcgW2Fyck1heF07DQoJcHJpdmF0ZSBTdHJpbmdbXSBhcnJGYWNpID0gbmV3IFN0cmluZyBbYXJyTWF4XTsNCglwcml2YXRlIFN0cmluZ1tdIGFyclFyaWQgPSBuZXcgU3RyaW5nIFthcnJNYXhdOw0KDQoJcHJpdmF0ZSBTdHJpbmdbXSBhcnIwUmlkbiA9IG5ldyBTdHJpbmcgW2Fyck1heF07DQoJcHJpdmF0ZSBpbnRbXSBhcnIwUmlkbCA9IG5ldyBpbnQgW2Fyck1heF07DQoJcHJpdmF0ZSBpbnRbXSBhcnIwUmlkeCA9IG5ldyBpbnQgW2Fyck1heF07DQoJcHJpdmF0ZSBTdHJpbmdbXSBhcnIwSXRubyA9IG5ldyBTdHJpbmcgW2Fyck1heF07DQoJcHJpdmF0ZSBTdHJpbmdbXSBhcnIwQmFubyA9IG5ldyBTdHJpbmcgW2Fyck1heF07DQoNCglwcml2YXRlIGludCBpID0gMDsNCglwcml2YXRlIGludCBpbnRWYWwgPSAwOw0KCXByaXZhdGUgaW50IGNvbXBhcmVSZXN1bHQgPSAwOw0KCXByaXZhdGUgaW50IGludENvbm8gPSBwcm9ncmFtLkxEQVpELmdldCgiQ09OTyIpOw0KCXByaXZhdGUgU3RyaW5nIGlDb25vID0gcHJvZ3JhbS5MREFaRC5nZXQoIkNPTk8iKTsNCglwcml2YXRlIFN0cmluZyBjb21wYXJlVmFsdWUgPSAiIjsNCglwcml2YXRlIFN0cmluZyBzdHJKb2JuID0gcHJvZ3JhbS5nZXRKb2JOdW1iZXIoKTsNCglwcml2YXRlIFN0cmluZ1tdIGFyckpPQk4gPSBuZXcgU3RyaW5nIFsxMF07DQoJcHJpdmF0ZSBpbnQgcmVnZGF0ZT0wOw0KCXByaXZhdGUgaW50IHJlZ3RpbWU9MDsNCg0KCXB1YmxpYyBTQ0VfQmF0Y2hfQ1JFWFRQUlRfUU1TNjAxUEYoTWV0aG9kQVBJIG1ldGhvZCwgTG9nZ2VyQVBJIGxvZ2dlciwgUHJvZ3JhbUFQSSBwcm9ncmFtLCBEYXRhYmFzZUFQSSBkYXRhYmFzZSkgew0KCQl0aGlzLmxvZ2dlciA9IGxvZ2dlcjsNCgkJdGhpcy5tZXRob2QgPSBtZXRob2Q7DQoJCXRoaXMucHJvZ3JhbSA9IHByb2dyYW07DQoJCXRoaXMuZGF0YWJhc2UgPSBkYXRhYmFzZTsNCgl9DQoNCg0KCXB1YmxpYyB2b2lkIG1haW4oKSB7DQoJCWxvZ2dlci5kZWJ1ZyAoIlNDRV9CYXRjaF9DUkVYVFBSVF9RTVM2MDFQRiIpOw0KCQlMb2NhbERhdGVUaW1lIG5vdyA9IExvY2FsRGF0ZVRpbWUubm93KCk7DQoJCURhdGVUaW1lRm9ybWF0dGVyIGZvcm1hdDEgPSBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIik7DQoJCVN0cmluZyBmb3JtYXREYXRlID0gbm93LmZvcm1hdChmb3JtYXQxKTsNCgkJRGF0ZVRpbWVGb3JtYXR0ZXIgZm9ybWF0MiA9IERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiSEhtbXNzIik7DQoJCVN0cmluZyBmb3JtYXRUaW1lID0gbm93LmZvcm1hdChmb3JtYXQyKTsNCg0KCQlyZWdkYXRlPUludGVnZXIucGFyc2VJbnQoZm9ybWF0RGF0ZSk7DQoJCXJlZ3RpbWU9SW50ZWdlci5wYXJzZUludChmb3JtYXRUaW1lKTsNCg0KCQl3b3JrT25RTVM2MDFQRigpOw0KCQlyZW9yZ0VYVDYwMSgpOw0KCX0NCg0KCS8qKg0KCSAqIHN0YXJ0IHdvcmtpbmcgZm9yIHByaW50IG91dCBkYXRhIG9mIFFNUzYwMQ0KCSAqLw0KCXZvaWQgd29ya09uUU1TNjAxUEYoKSB7DQoJCS8vY2hlY2sgaWYgY29ycmVjdCBwcmludGVyIGZpbGUgaXMgdXNlZCBmb3IgZm9sbG93aW5nIGluc3RydWN0aW9ucw0KCQlwcmludGVyRmlsZSA9IG1ldGhvZC5nZXRBcmd1bWVudCgwKSBhcyBTdHJpbmc7DQoJCWlmICghcHJpbnRlckZpbGUuZXF1YWxzKCJRTVM2MDFQRiIpKSB7DQoJCQlsb2dnZXIuZGVidWcgKCJwcmludGVyZmlsZSBpcyBub3QgUU1TNjAxUEYiKTsNCgkJCXJldHVybjsNCgkJfQ0KCQkvL2NoZWNrIGlmIGNvcnJlY3QgcHJpbnRlciBibG9jayBvZiB0aGUgcHJpbnRlciBmaWxlIGlzIHVzZWQNCgkJam9iTnVtYmVyID0gbWV0aG9kLmdldEFyZ3VtZW50KDEpIGFzIFN0cmluZzsNCgkJc3RydWN0dXJlID0gbWV0aG9kLmdldEFyZ3VtZW50KDIpIGFzIFN0cmluZzsNCgkJdmFyaWFudCA9IG1ldGhvZC5nZXRBcmd1bWVudCgzKSBhcyBpbnQ7DQoJCXJwYmsgID0gbWV0aG9kLmdldEFyZ3VtZW50KDQpIGFzIGludDsNCgkJLy9uYW1lIG9mIHRoZSBzdHJ1Y3R1cmUNCgkJaWYgKCFzdHJ1Y3R1cmUuZXF1YWxzKCJDRF9DVVNfMDItMDEiKQ0KCQkJCSYmICAhc3RydWN0dXJlLmVxdWFscygiTTNfU1REXzAyLTAxIikNCgkJCQkpIHsNCgkJCWxvZ2dlci5kZWJ1ZyAoIlFNUzYwMVBGIC0gbm90IHVzZWQgc3RydWN0dXJlOiAiICsgc3RydWN0dXJlICsgIiBycGJrOiAiICsgcnBiayk7DQoJCQlyZXR1cm47DQoJCX0NCg0KCQlsb2dnZXIuZGVidWcgKCJRTVM2MDFQRiB1c2VkIHN0cnVjdHVyZTogIiArIHN0cnVjdHVyZSArICIgcnBiazogIiArIHJwYmspOw0KCQkvL29ubHkgc3RhcnQgd29ya2luZyBmb3IgUU1TNjAxUEYgeG1sIGJsb2NrIDIwDQoJCWlmIChycGJrICE9IDIwKSB7DQoJCQlyZXR1cm47DQoJCX0NCg0KCQkvL2NoZWNrIGlmIHRoZSBwcmludCBibG9jayBpcyBpbmNsdWRpbmcgZXhwZWN0ZWQgZGF0YQ0KCQlmaWVsZE1hcCA9IG1ldGhvZC5nZXRBcmd1bWVudCg1KSBhcyBIYXNoTWFwOw0KCQlpZiAoZmllbGRNYXAgPT0gbnVsbCkgew0KCQkJbG9nZ2VyLmRlYnVnICgibm8gZGF0YSBmb3VuZCBpbiAnbWV0aG9kLmdldEFyZ3VtZW50KDUpJyAiKTsNCgkJCXJldHVybjsNCgkJfSBlbHNlIHsNCgkJCWxvZ2dlci5kZWJ1ZyAoImZpZWxkTWFwOiAiICsgZmllbGRNYXApOw0KCQl9DQoNCgkJaUJhbm8gPSBmaWVsZE1hcC5nZXQoIiZCQU5PIik7DQoJCWlJdG5vID0gZmllbGRNYXAuZ2V0KCImSVROTyIpOw0KCQlpUmlkbiA9IGZpZWxkTWFwLmdldCgiJlJJRE4iKTsNCgkJaVJpZGkgPSBmaWVsZE1hcC5nZXQoIiZSSURJIik7DQoNCgkJbG9nZ2VyLmRlYnVnKCJpQmFubzogIiArIGlCYW5vDQoJCQkJKyAiaUl0bm86ICIgKyBpSXRubw0KCQkJCSsgImlSaWRuOiAiICsgaVJpZG4NCgkJCQkrICJpUmlkaTogIiArIGlSaWRpKTsNCg0KCQkvL2NoZWNrIGlCYW5vDQoJCWlmIChpQmFubyA9PSBudWxsKSB7DQoJCQlpQmFubyA9ICIiOw0KCQl9DQoJCS8vY2hlY2sgaUl0bm8NCgkJaWYgKGlJdG5vID09IG51bGwpIHsNCgkJCWlJdG5vID0gIiI7DQoJCX0NCgkJaWYgKGlJdG5vLnRyaW0oKS5pc0VtcHR5KCkpIHsNCgkJCWxvZ2dlci5kZWJ1ZyAoIlNDRV9CYXRjaF9DUkVYVFBSVF9RTVM2MDFQRiBmaWVsZCBJVE5PIGZyb20gZmllbGRNYXAgaXMgZW10cHkiKTsNCgkJCXJldHVybjsNCgkJfQ0KCQkvL2NoZWNrIGlSaWRuDQoJCWlmIChpUmlkbiA9PSBudWxsKSB7DQoJCQlpUmlkbiA9ICIiOw0KCQl9DQoJCWlmIChpUmlkbi50cmltKCkuaXNFbXB0eSgpKSB7DQoJCQlsb2dnZXIuZGVidWcgKCJTQ0VfQmF0Y2hfQ1JFWFRQUlRfUU1TNjAxUEYgZmllbGQgUklETiBmcm9tIGZpZWxkTWFwIGlzIGVtdHB5Iik7DQoJCQlyZXR1cm47DQoJCX0NCgkJLy9jaGVjayBpUmlkaQ0KCQlpZiAoaVJpZGkgPT0gbnVsbCkgew0KCQkJaVJpZGkgPSAiIjsNCgkJfQ0KCQlpZiAoaVJpZGkudHJpbSgpLmlzRW1wdHkoKSkgew0KCQkJbG9nZ2VyLmRlYnVnICgiU0NFX0JhdGNoX0NSRVhUUFJUX1FNUzYwMVBGIGZpZWxkIFJJREkgZnJvbSBmaWVsZE1hcCBpcyBlbXRweSIpOw0KCQkJcmV0dXJuOw0KCQl9DQoJCWludFZhbCA9IGlSaWRpLmluZGV4T2YoJy4nKTsNCg0KCQlsb25nUmlkaSA9IExvbmcucGFyc2VMb25nKGlSaWRpLnN1YnN0cmluZygwLCBpbnRWYWwpKTsNCg0KCQltaXR4UmlkbiA9ICIiOw0KCQltaXR4UmlkbCA9IDBsOw0KCQltaXR4UmlkeCA9IDBsOw0KCQltaXR4V2hsbyA9ICIiOw0KCQltaXR4SXRubyA9ICIiOw0KCQltaXR4QmFubyA9ICIiOw0KCQltYWludGFpbkFycjYwMCgiY2xlYXIiLCBtaXR4UmlkbiwgbWl0eFJpZGwsIG1pdHhSaWR4LCBtaXR4SXRubywgbWl0eEJhbm8pOw0KCQltYWludGFpbkFycmF5cygiY2xlYXIiLCBtaXR4UmlkbiwgbWl0eFJpZGwsIG1pdHhSaWR4LCBtaXR4V2hsbywgbWl0eEl0bm8sIG1pdHhCYW5vKTsNCg0KCQlEQkFjdGlvbiBhY3Rpb25NaXRhbG8gPSBkYXRhYmFzZS50YWJsZSgiTUlUQUxPIikNCgkJCQkuaW5kZXgoIjIwIikNCgkJCQkuc2VsZWN0aW9uKCJNUVRUWVAiLCAiTVFSSUROIiwgIk1RUklETCIsICJNUVJJRFgiLCAiTVFXSExPIiwgIk1RQkFOTyIsICJNUUlUTk8iKQ0KCQkJCS5idWlsZCgpOw0KCQlEQkNvbnRhaW5lciBNSVRBTE8gPSBhY3Rpb25NaXRhbG8uZ2V0Q29udGFpbmVyKCk7DQoJCU1JVEFMTy5zZXQoIk1RQ09OTyIsIGludENvbm8pOw0KCQlNSVRBTE8uc2V0KCJNUVRUWVAiLCBjb25zdFRUWVAzMSk7DQoJCU1JVEFMTy5zZXQoIk1RUklETiIsIGlSaWRuKTsNCg0KCQlhY3Rpb25NaXRhbG8ucmVhZEFsbChNSVRBTE8sIDMsIG1pdGFsb0ZvclJpZG4pOw0KDQoJCURCQWN0aW9uIGFjdGlvbk1pdHRyYSA9IGRhdGFiYXNlLnRhYmxlKCJNSVRUUkEiKQ0KCQkJCS5pbmRleCgiMjAiKQ0KCQkJCS5zZWxlY3Rpb24oIk1UVFRZUCIsICJNVFJJRE4iLCAiTVRSSURMIiwgIk1UUklEWCIsICJNVFdITE8iLCAiTVRCQU5PIiwgIk1USVROTyIpDQoJCQkJLmJ1aWxkKCk7DQoJCURCQ29udGFpbmVyIE1JVFRSQSA9IGFjdGlvbk1pdHRyYS5nZXRDb250YWluZXIoKTsNCgkJTUlUVFJBLnNldCgiTVRDT05PIiwgaW50Q29ubyk7DQoJCU1JVFRSQS5zZXQoIk1USVROTyIsIGlJdG5vKTsNCgkJTUlUVFJBLnNldCgiTVRCQU5PIiwgaUJhbm8pOw0KCQlNSVRUUkEuc2V0KCJNVFRUWVAiLCBjb25zdFRUWVAzMSk7DQoJCU1JVFRSQS5zZXQoIk1UUklETiIsIGlSaWRuKTsNCg0KCQlhY3Rpb25NaXR0cmEucmVhZEFsbChNSVRUUkEsIDUsIG1pdHRyYUZvclJpZG4pOw0KDQoJCWxvZ2dlci5kZWJ1ZygiYWZ0ZXIgbWl0dHJhRm9yUmlkbi5yZWFkQWxsICIpOw0KDQoJCWZvciAoaW50IHggPSAwOyB4IDwgYXJyTWF4OyB4KyspIHsNCgkJCW1pdHhSaWRuID0gYXJyUmlkblt4XTsNCgkJCWlmIChtaXR4Umlkbi5pc0VtcHR5KCkpIHsNCgkJCQlicmVhazsNCgkJCX0gZWxzZSB7DQoJCQkJbWl0eFJpZGwgPSBhcnJSaWRsW3hdOw0KCQkJCW1pdHhSaWR4ID0gYXJyUmlkeFt4XTsNCgkJCQltaXR4V2hsbyA9IGFycldobG9beF07DQoJCQkJbWl0eEl0bm8gPSBhcnJJdG5vW3hdOw0KCQkJCW1pdHhCYW5vID0gYXJyQmFub1t4XTsNCgkJCQlnZXRIaWdoZXN0UVJJREZyb21RUkgoeCwgbWl0eEl0bm8sIG1pdHhCYW5vKTsNCgkJCX0NCgkJfQ0KDQoJCWZvciAoaW50IHggPSAwOyB4IDwgYXJyTWF4OyB4KyspIHsNCgkJCW1pdHhSaWRuID0gYXJyUmlkblt4XTsNCgkJCWlmIChtaXR4Umlkbi5pc0VtcHR5KCkpIHsNCgkJCQlicmVhazsNCgkJCX0gZWxzZSB7DQoJCQkJZGVsZXRlRVhUNjAwX1JJRE4oYXJyUmlkblt4XSwgYXJyUmlkbFt4XSwgYXJyUmlkeFt4XSwgYXJySXRub1t4XSwgYXJyQmFub1t4XSk7DQoJCQkJZGVsZXRlRVhUNjAxX1JJRE4oYXJyUmlkblt4XSwgYXJyUmlkbFt4XSwgYXJyUmlkeFt4XSwgYXJySXRub1t4XSwgYXJyQmFub1t4XSk7DQoJCQl9DQoJCX0NCg0KCQlmb3IgKGludCB4ID0gMDsgeCA8IGFyck1heDsgeCsrKSB7DQoJCQltaXR4UmlkbiA9IGFyclJpZG5beF07DQoJCQlpZiAobWl0eFJpZG4uaXNFbXB0eSgpKSB7DQoJCQkJYnJlYWs7DQoJCQl9DQoJCQlxbXNycWhRcmlkID0gIGFyclFyaWRbeF07DQoJCQlpZiAoIXFtc3JxaFFyaWQuaXNFbXB0eSgpKSB7DQoJCQkJbWl0eFJpZG4gPSBhcnJSaWRuW3hdLnRyaW0oKTsNCgkJCQltaXR4UmlkbCA9IGFyclJpZGxbeF07DQoJCQkJbWl0eFJpZHggPSBhcnJSaWR4W3hdOw0KCQkJCW1pdHhXaGxvID0gYXJyV2hsb1t4XS50cmltKCk7DQoJCQkJbWl0eEl0bm8gPSBhcnJJdG5vW3hdLnRyaW0oKTsNCgkJCQltaXR4QmFubyA9ICBhcnJCYW5vW3hdLnRyaW0oKTsNCgkJCQlxbXNycWhGYWNpID0gYXJyRmFjaVt4XS50cmltKCk7DQoJCQkJcW1zcnFoUXJpZCA9IGFyclFyaWRbeF0udHJpbSgpOw0KCQkJCWludFZhbCA9IHg7DQoJCQkJbG9nZ2VyLmRlYnVnKCJhZnRlciBnZXRIaWdoZXN0UVJJREZyb21RUkggc3RhcnQgY3JlYXRlRVhUNjAxIHdpdGggIg0KCQkJCQkJKyAiUklETjogIiArIG1pdHhSaWRuDQoJCQkJCQkrICJSSURMOiAiICsgbWl0eFJpZGwNCgkJCQkJCSsgIlJJRFg6ICIgKyBtaXR4UmlkeA0KCQkJCQkJKyAiV0hMTzogIiArIG1pdHhXaGxvDQoJCQkJCQkrICJJVE5POiAiICsgbWl0eEl0bm8NCgkJCQkJCSsgIkZBQ0k6ICIgKyBxbXNycWhGYWNpDQoJCQkJCQkrICJRUklEOiAiICsgcW1zcnFoUXJpZA0KCQkJCQkJKyAiaW50VmFsOiAiICsgeA0KCQkJCQkJKTsNCgkJCQljcmVhdGVFWFQ2MDFGcm9tUU1TUlFUKCk7DQoJCQl9DQoJCX0NCgkJZm9yIChpbnQgeCA9IDA7IHggPCBhcnJNYXg7IHgrKykgew0KCQkJbWl0eFJpZG4gPSBhcnIwUmlkblt4XTsNCgkJCWlmIChtaXR4Umlkbi5pc0VtcHR5KCkpIHsNCgkJCQlicmVhazsNCgkJCX0NCgkJCW1pdHhSaWRuID0gYXJyMFJpZG5beF0udHJpbSgpOw0KCQkJbWl0eFJpZGwgPSBhcnIwUmlkbFt4XTsNCgkJCW1pdHhSaWR4ID0gYXJyMFJpZHhbeF07DQoJCQltaXR4SXRubyA9IGFycjBJdG5vW3hdLnRyaW0oKTsNCgkJCW1pdHhCYW5vID0gYXJyMEJhbm9beF0udHJpbSgpOw0KCQkJaW50VmFsID0geDsNCgkJCWNyZWF0ZUVYVDYwMCgpOw0KCQl9DQoNCgkJLy9kZWxldGUgb2xkIFJJRE4gcmVsYXRlZCBkYXRhLCBub3QgYmVsb25naW5nIHRvIHRoaXMgSk9CDQoJCW1pdHhSaWRuID0gIiI7DQoJCWZvciAoaW50IHggPSAwOyB4IDwgYXJyTWF4OyB4KyspIHsNCgkJCWlmICghbWl0eFJpZG4uaXNFbXB0eSgpDQoJCQkJCSYmICBhcnJSaWRuW3hdLnRyaW0oKS5jb250ZW50RXF1YWxzKG1pdHhSaWRuKSkgew0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQkJbWl0eFJpZG4gPSBhcnJSaWRuW3hdLnRyaW0oKTsNCgkJCWlmIChtaXR4Umlkbi5pc0VtcHR5KCkpIHsNCgkJCQlicmVhazsNCgkJCX0NCg0KCQkJZGVsZXRlRVhUNjAwX1JJRE4oYXJyUmlkblt4XSk7DQoJCQlkZWxldGVFWFQ2MDFfUklETihhcnJSaWRuW3hdKTsNCgkJfQ0KCX0NCg0KCUNsb3N1cmU8Pz4gbWl0YWxvRm9yUmlkbiA9IHsgREJDb250YWluZXIgTUlUQUxPIC0+DQoJCW1pdHhCYW5vID0gTUlUQUxPLmdldCgiTVFCQU5PIik7DQoJCW1pdHhJdG5vID0gTUlUQUxPLmdldCgiTVFJVE5PIik7DQoJCWxvZ2dlci5kZWJ1ZygibWl0YWxvRm9yUmlkbiBjaGVjayBtaXR4SXRubzogIiArICBtaXR4SXRubyArICIgRVEgaUl0bm86ICIgKyBpSXRubyk7DQoJCWlmIChtaXR4SXRuby50cmltKCkuY29udGVudEVxdWFscyhpSXRuby50cmltKCkpKSB7DQoJCQltaXR4UmlkbiA9IE1JVEFMTy5nZXQoIk1RUklETiIpOw0KCQkJbWl0eFJpZGwgPSBNSVRBTE8uZ2V0KCJNUVJJREwiKTsNCgkJCW1pdHhSaWR4ID0gTUlUQUxPLmdldCgiTVFSSURYIik7DQoJCQltaXR4V2hsbyA9IE1JVEFMTy5nZXQoIk1RV0hMTyIpOw0KCQkJbWFpbnRhaW5BcnJheXMoImFkZCIsIG1pdHhSaWRuLCBtaXR4UmlkbCwgbWl0eFJpZHgsIG1pdHhXaGxvLCBtaXR4SXRubywgbWl0eEJhbm8pOw0KCQl9DQoJfQ0KDQoJQ2xvc3VyZTw/PiBtaXR0cmFGb3JSaWRuID0geyBEQkNvbnRhaW5lciBNSVRUUkEgLT4NCgkJbWl0eEJhbm8gPSBNSVRUUkEuZ2V0KCJNVEJBTk8iKTsNCgkJbWl0eEl0bm8gPSBNSVRUUkEuZ2V0KCJNVElUTk8iKTsNCgkJbG9nZ2VyLmRlYnVnKCJtaXR0cmFGb3JSaWRuIGNoZWNrIG1pdHhJdG5vOiAiICsgIG1pdHhJdG5vICsgIiBFUSBpSXRubzogIiArIGlJdG5vKTsNCgkJaWYgKG1pdHhJdG5vLnRyaW0oKS5jb250ZW50RXF1YWxzKGlJdG5vLnRyaW0oKSkpIHsNCgkJCW1pdHhSaWRuID0gTUlUVFJBLmdldCgiTVRSSUROIik7DQoJCQltaXR4UmlkbCA9IE1JVFRSQS5nZXQoIk1UUklETCIpOw0KCQkJbWl0eFJpZHggPSBNSVRUUkEuZ2V0KCJNVFJJRFgiKTsNCgkJCW1pdHhXaGxvID0gTUlUVFJBLmdldCgiTVRXSExPIik7DQoJCQltYWludGFpbkFycmF5cygiYWRkIiwgbWl0eFJpZG4sIG1pdHhSaWRsLCBtaXR4UmlkeCwgbWl0eFdobG8sIG1pdHhJdG5vLCBtaXR4QmFubyk7DQoJCX0NCgl9DQoNCgkvKioNCgkgKiBnZXRIaWdoZXN0UVJJREZyb21RUkgoKQ0KCSAqDQoJICogZ2V0IG51bWVyaWMgaGlnaGVzdCAobGF0ZXN0KSB2YWx1ZSBRUklEIGZvciBhbHJlYWR5IGRvbmUgdGVzdHMNCgkgKi8NCglwdWJsaWMgdm9pZCBnZXRIaWdoZXN0UVJJREZyb21RUkgoaW50IHgsIFN0cmluZyBpdG5vLCBTdHJpbmcgYmFubykgew0KCQlsb2dnZXIuZGVidWcoImdldEhpZ2hlc3RRUklERnJvbVFSSCB4L2l0bm8vYmFubyAiICsgeCArICIvIiArIGl0bm8gKyAiLyIgKyBiYW5vKTsNCgkJaW50VmFsID0geDsNCgkJREJBY3Rpb24gYWN0aW9uUU1TUlFIID0gZGF0YWJhc2UudGFibGUoIlFNU1JRSCIpDQoJCQkJLmluZGV4KCIzMCIpDQoJCQkJLnNlbGVjdGlvbigiUkhGQUNJIiwgIlJIUVJJRCIsICJSSFFTVEEiKQ0KCQkJCS5idWlsZCgpOw0KCQlEQkNvbnRhaW5lciBRTVNSUUggPSBhY3Rpb25RTVNSUUguZ2V0Q29udGFpbmVyKCk7DQoJCVFNU1JRSC5zZXQoIlJIQ09OTyIsIGludENvbm8pOw0KCQlRTVNSUUguc2V0KCJSSElUTk8iLCBpdG5vKTsNCgkJUU1TUlFILnNldCgiUkhCQU5PIiwgYmFubyk7DQoNCgkJYWN0aW9uUU1TUlFILnJlYWRBbGwoUU1TUlFILCAzLCBxbXNycWhGb3JCQU5PKTsNCgl9DQoNCglDbG9zdXJlPD8+IHFtc3JxaEZvckJBTk8gPSB7IERCQ29udGFpbmVyIFFNU1JRSCAtPg0KCQlxbXNycWhGYWNpID0gUU1TUlFILmdldCgiUkhGQUNJIik7DQoJCXFtc3JxaFFyaWQgPSBRTVNSUUguZ2V0KCJSSFFSSUQiKTsNCgkJcW1zcnFoUXN0YSA9IFFNU1JRSC5nZXQoIlJIUVNUQSIpOw0KCQlsb2dnZXIuZGVidWcgKCJxbXNycWhGb3JCQU5PIHFtc3JxaFFJRDogIiArIHFtc3JxaFFyaWQpOw0KCQlpZiAocW1zcnFoUXN0YSA9PSAzKSB7DQoJCQlpZiAoYXJyRmFjaVtpbnRWYWxdLmlzRW1wdHkoKSkgew0KCQkJCWFyckZhY2lbaW50VmFsXSA9IHFtc3JxaEZhY2k7DQoJCQkJYXJyUXJpZFtpbnRWYWxdID0gcW1zcnFoUXJpZDsNCgkJCQlsb2dnZXIuZGVidWcgKCJzYXZlIGZpcnN0IFFNU1JRSCBGQUNJL1FSSUQ6ICIgKyBxbXNycWhGYWNpICsgIi8iICsgcW1zcnFoUXJpZCk7DQoJCQl9IGVsc2Ugew0KDQoJCQkJY29tcGFyZVJlc3VsdCA9IHFtc3JxaFFyaWQudHJpbSgpLmNvbXBhcmVUbyhhcnJRcmlkW2ludFZhbF0udHJpbSgpKTsNCgkJCQlpZiAoY29tcGFyZVJlc3VsdCA8IDApICB7DQoJCQkJCWFyclFyaWRbaW50VmFsXSA9IHFtc3JxaFFyaWQ7DQoJCQkJCWFyckZhY2lbaW50VmFsXSA9IHFtc3JxaEZhY2k7DQoJCQkJCWxvZ2dlci5kZWJ1ZyAoInNhdmUgY29tcGFyYXRpb24gcmVzdWx0IFFNU1JRSCBGQUNJL1FSSUQ6ICIgKyBxbXNycWhGYWNpICsgIi8iICsgcW1zcnFoUXJpZCk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJbG9nZ2VyLmRlYnVnICgiY29tcGFyYXRpb24gcmVzdWx0IDwgMCBGQUNJL1FSSUQ6ICIgKyBxbXNycWhGYWNpICsgIi8iICsgcW1zcnFoUXJpZCk7DQoJCQkJfQ0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJbG9nZ2VyLmRlYnVnICgicW1zcnFoRm9yQkFOTyBxbXNycWhRc3RhICE9IDMgcW1zcnFoUXN0YTogIiArIHFtc3JxaFFzdGEpOw0KCQl9DQoJfQ0KDQoJLyoqDQoJICogY3JlYXRlRVhUNjAwKCkNCgkgKg0KCSAqIGNyZWF0ZSBub3QgZXhpc3RpbmcgRVhUNjAwIGRhdGENCgkgKi8NCglwdWJsaWMgdm9pZCBjcmVhdGVFWFQ2MDAoKSB7DQoJCU9wdGlvbmFsPERCQ29udGFpbmVyPiBFWFQ2MDAgPSByZWFkRVhUNjAwKCk7DQoJCWlmKCFFWFQ2MDAuaXNQcmVzZW50KCkpew0KCQkJbG9nZ2VyLmRlYnVnICgibm90IEVYVDYwMCBpc1ByZXNlbnQgPj4+ICBjYWxsIGFkZEVYVDYwMCIpDQoJCQlhZGRFWFQ2MDAoKTsNCgkJfQ0KCX0NCg0KCS8qKg0KCSAqIHJlYWRFWFQ2MDAoKQ0KCSAqDQoJICogcmV0dXJucyB0aGUgRVhUNjAwIHJlY29yZCBvciBhbiBlbXB0eSByZWNvcmQgZm9yIHRoZSBnaXZlbiBrZXkgZGF0YQ0KCSAqLw0KCXByaXZhdGUgT3B0aW9uYWw8REJDb250YWluZXI+IHJlYWRFWFQ2MDAoKSB7DQoJCWxvZ2dlci5kZWJ1Zygic3RhcnQgcmVhZEVYVDYwMSB3aXRoIGtleSBqb2JuOiAiICsgc3RySm9ibg0KCQkJCSsgIiByaWRuOiAiICsgbWl0eFJpZG4NCgkJCQkrICIgcmlkbDogIiArIG1pdHhSaWRsDQoJCQkJKyAiIHJpZHg6ICIgKyBtaXR4UmlkeA0KCQkJCSsgIiBpdG5vOiAiICsgbWl0eEl0bm8NCgkJCQkrICIgYmFubzogIiArIG1pdHhCYW5vDQoJCQkJKTsNCgkJREJBY3Rpb24gYWN0aW9uRVhUNjAwID0gZGF0YWJhc2UudGFibGUoIkVYVDYwMCIpDQoJCQkJLmluZGV4KCIwMCIpDQoJCQkJLmJ1aWxkKCk7DQoJCURCQ29udGFpbmVyIEVYVDYwMCA9IGFjdGlvbkVYVDYwMC5nZXRDb250YWluZXIoKTsNCgkJLy8gS2V5IHZhbHVlIGZvciByZWFkDQoJCUVYVDYwMC5zZXQoIkVYQ09OTyIsIGludENvbm8pOw0KCQlFWFQ2MDAuc2V0KCJFWFJPUkMiLCBjb25zdFJPUkMzKTsNCgkJRVhUNjAwLnNldCgiRVhST1JOIiwgbWl0eFJpZG4pOw0KCQlFWFQ2MDAuc2V0KCJFWFJPUkwiLCBtaXR4UmlkbCk7DQoJCUVYVDYwMC5zZXQoIkVYUk9SWCIsIG1pdHhSaWR4KTsNCgkJRVhUNjAwLnNldCgiRVhJVE5PIiwgbWl0eEl0bm8pOw0KCQlFWFQ2MDAuc2V0KCJFWEJBTk8iLCBtaXR4QmFubyk7DQoJCUVYVDYwMC5zZXQoIkVYSk9CTiIsIHN0ckpvYm4pOw0KDQoJCS8vIFJlYWQNCgkJaWYgKGFjdGlvbkVYVDYwMC5yZWFkKEVYVDYwMCkpIHsNCgkJCWxvZ2dlci5kZWJ1ZygicmVhZEVYVDYwMCByZWNvcmQgaXMgZXhpc3RpbmciKTsNCgkJCXJldHVybiBPcHRpb25hbC5vZihFWFQ2MDApOw0KCQl9DQoNCgkJbG9nZ2VyLmRlYnVnKCJyZWFkRVhUNjAwIHJlY29yZCBpcyBub3QgZXhpc3RpbmciKTsNCgkJcmV0dXJuIE9wdGlvbmFsLmVtcHR5KCk7DQoJfQ0KDQoJLyoqDQoJICogYWRkRVhUNjAwDQoJICoNCgkgKiBhZGQgYSBuZXcgcmVjb3JkIHRvIGZpbGUgRVhUNjAwDQoJICovDQoJcHJpdmF0ZSB2b2lkIGFkZEVYVDYwMCgpIHsNCgkJbG9nZ2VyLmRlYnVnKCJPdXRwdXRQcm9jZXNzR1lfQ01SIGFkZEVYVDYwMCIpOw0KCQlEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAwIikNCgkJCQkuaW5kZXgoIjAwIikNCgkJCQkuc2VsZWN0QWxsRmllbGRzKCkNCgkJCQkuYnVpbGQoKTsNCgkJREJDb250YWluZXIgRVhUNjAwID0gYWN0aW9uLmNyZWF0ZUNvbnRhaW5lcigpOw0KCQkvLyBLZXkgdmFsdWUNCgkJRVhUNjAwLnNldCgiRVhKT0JOIiwgc3RySm9ibik7DQoJCUVYVDYwMC5zZXQoIkVYQ09OTyIsIGludENvbm8pOw0KCQlFWFQ2MDAuc2V0KCJFWFJPUkMiLCBjb25zdFJPUkMzKTsNCgkJRVhUNjAwLnNldCgiRVhST1JOIiwgbWl0eFJpZG4pOw0KCQlFWFQ2MDAuc2V0KCJFWFJPUkwiLCBtaXR4UmlkbCk7DQoJCUVYVDYwMC5zZXQoIkVYUk9SWCIsIG1pdHhSaWR4KTsNCgkJRVhUNjAwLnNldCgiRVhJVE5PIiwgbWl0eEl0bm8pOw0KCQlFWFQ2MDAuc2V0KCJFWEJBTk8iLCBtaXR4QmFubyk7DQoJCS8vc3RhdGlzdGljYWwgaW5mb3JtYXRpb24NCgkJRVhUNjAwLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpOw0KCQlFWFQ2MDAuc2V0KCJFWENITk8iLCAxKTsNCgkJRVhUNjAwLnNldCgiRVhSR0RUIiwgcmVnZGF0ZSk7DQoJCUVYVDYwMC5zZXQoIkVYTE1EVCIsIHJlZ2RhdGUpOw0KCQlFWFQ2MDAuc2V0KCJFWFJHVE0iLCByZWd0aW1lKTsNCgkJYWN0aW9uLmluc2VydChFWFQ2MDApOw0KCX0NCg0KCS8qKiBjcmVhdGVFWFQ2MDFGcm9tUU1TUlFUDQoJICogCXVzZSBkYXRhIGZyb20gaW50ZXJuYWwgYXJyYXlzIHRvIHJlYWQgYWxsIGdlbmVyYXRlZCB0ZXN0IGRhdGEgZnJvbSBRTVNPVFMNCgkgKiAgdXNlIGRhdGEgZnJvbSBmb3VuZCBkYXRhIGluIFFNU09UUywgZnJvbSB0aGUgYXJyYXlzIGFuZCBmcm9tIFFNU1JRSCBmb3IgZ2V0dGluZw0KCSAqICBkYXRhIGZyb20gUU1TUlFUDQoJICogIGZvciBleGlzdGluZyBRTVNSUVQgcmVjb3JkcyBjcmVhdGUgb3V0cHV0IHJlY29yZHMgaW4gRVhUNjAxDQoJICovDQoJcHVibGljIHZvaWQgY3JlYXRlRVhUNjAxRnJvbVFNU1JRVCgpIHsNCgkJbG9nZ2VyLmRlYnVnICgic3RhcnQgY3JlYXRlRVhUNjAxRnJvbVFNU1JRVCBST1JOL1JPUkwvUk9SWC9JVE5PL0ZBQ0kvUVJJRCAiDQoJCQkJKyBtaXR4Umlkbg0KCQkJCSsgIi8iICsgbWl0eFJpZGwNCgkJCQkrICIvIiArIG1pdHhSaWR4DQoJCQkJKyAiLyIgKyBtaXR4SXRubw0KCQkJCSsgIi8iICsgcW1zcnFoRmFjaQ0KCQkJCSsgIi8iICsgcW1zcnFoUXJpZA0KCQkJCSk7DQoJCURCQWN0aW9uIGFjdGlvblFNU09UUyA9IGRhdGFiYXNlLnRhYmxlKCJRTVNPVFMiKQ0KCQkJCS5pbmRleCgiMjAiKQ0KCQkJCS5zZWxlY3Rpb24oIlFUUVRTVCIsICJRVFRTVFkiLCAiUVRRVEUxIiwgIlFUUVRFMiIsICJRVFNQRUMiLCAiUVRRU0UxIiwgIlFUUVNFMiIsICJRVEVWTU4iLCAiUVRFVk1YIiwgIlFURENDRCIpDQoJCQkJLmJ1aWxkKCk7DQoJCURCQ29udGFpbmVyIFFNU09UUyA9IGFjdGlvblFNU09UUy5nZXRDb250YWluZXIoKTsNCgkJUU1TT1RTLnNldCgiUVRDT05PIiwgaW50Q29ubyk7DQoJCVFNU09UUy5zZXQoIlFUUk9SQyIsIGNvbnN0Uk9SQzMpOw0KCQlRTVNPVFMuc2V0KCJRVFJPUk4iLCBtaXR4Umlkbik7DQoJCVFNU09UUy5zZXQoIlFUUk9STCIsIG1pdHhSaWRsKTsNCgkJUU1TT1RTLnNldCgiUVRST1JYIiwgbWl0eFJpZHgpOw0KCQlRTVNPVFMuc2V0KCJRVElUTk8iLCBtaXR4SXRubyk7DQoNCgkJYWN0aW9uUU1TT1RTLnJlYWRBbGwoUU1TT1RTLCA2LCBxbXNvdHNGb3JRTVNSUVQpOw0KCX0NCg0KCUNsb3N1cmU8Pz4gcW1zb3RzRm9yUU1TUlFUID0geyBEQkNvbnRhaW5lciBRTVNPVFMgLT4NCgkJcW1zb3RzUXRzdCA9IFFNU09UUy5nZXQoIlFUUVRTVCIpOw0KCQlxbXNvdHNUc3R5ID0gUU1TT1RTLmdldCgiUVRUU1RZIik7DQoJCXFtc290c1F0ZTEgPSBRTVNPVFMuZ2V0KCJRVFFURTEiKTsNCgkJcW1zb3RzUXRlMiA9IFFNU09UUy5nZXQoIlFUUVRFMiIpOw0KCQlxbXNvdHNRc2UxID0gUU1TT1RTLmdldCgiUVRRU0UxIik7DQoJCXFtc290c1FzZTIgPSBRTVNPVFMuZ2V0KCJRVFFTRTIiKTsNCgkJcW1zb3RzRXZteCA9IFFNU09UUy5nZXQoIlFURVZNWCIpOw0KCQlxbXNvdHNFdm1uID0gUU1TT1RTLmdldCgiUVRFVk1OIik7DQoJCXFtc290c0RjY2QgPSBRTVNPVFMuZ2V0KCJRVERDQ0QiKTsNCg0KCQlsb2dnZXIuZGVidWcgKCJzdGFydCBjaGVjayBmb3IgU1BFQyBmcm9tIFFNU09UUyBpcyBjb25uZWN0ZWQgdG8gUU1TUlFTIHFtc3JxaFFyaWQvcW1zcnFoRmFjaTogIg0KCQkJCSsgIiAiICsgcW1zcnFoUXJpZA0KCQkJCSsgIi8iICsgcW1zcnFoRmFjaSk7DQoJCWZvdW5kUW1zcnFzU3BlYyA9IGZhbHNlOw0KCQlEQkFjdGlvbiBhY3Rpb25RTVNSUVMgPSBkYXRhYmFzZS50YWJsZSgiUU1TUlFTIikNCgkJCQkuaW5kZXgoIjAwIikNCgkJCQkuc2VsZWN0aW9uKCJSU1NQRUMiKQ0KCQkJCS5idWlsZCgpOw0KCQlEQkNvbnRhaW5lciBRTVNSUVMgPSBhY3Rpb25RTVNSUVMuZ2V0Q29udGFpbmVyKCk7DQoJCVFNU1JRUy5zZXQoIlJTQ09OTyIsIGludENvbm8pOw0KCQlRTVNSUVMuc2V0KCJSU0ZBQ0kiLCBxbXNycWhGYWNpKTsNCgkJUU1TUlFTLnNldCgiUlNRUklEIiwgcW1zcnFoUXJpZCk7DQoJCWFjdGlvblFNU1JRUy5yZWFkQWxsKFFNU1JRUywgMywgMSwgcW1zcnFzRm9yRXh0NjAxKTsNCgl9DQoNCglDbG9zdXJlPD8+IHFtc3Jxc0ZvckV4dDYwMSA9IHsgREJDb250YWluZXIgUU1TUlFTIC0+DQoJCXFtc3Jxc1NwZWMgPSBRTVNSUVMuZ2V0KCJSU1NQRUMiKTsNCgkJbG9nZ2VyLmRlYnVnICgiQ2xvc3VyZTw/PiBxbXNycXNGb3JFWFQ2MDEgY29tcGFyZSAiKTsNCgkJZm91bmRRbXNycXNTcGVjID0gdHJ1ZTsNCgkJRXhwcmVzc2lvbkZhY3RvcnkgZXhwcmVzc2lvbiA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJRTVNSUVQiKQ0KCQlleHByZXNzaW9uID0gZXhwcmVzc2lvbi5lcSgiUlRDT05PIiwgaW50Q29uby50b1N0cmluZygpKQ0KCQkJCS5hbmQoZXhwcmVzc2lvbi5lcSgiUlRRUklEIiwgcW1zcnFoUXJpZCkNCgkJCQkuYW5kKGV4cHJlc3Npb24uZXEoIlJUUVRTVCIsIHFtc290c1F0c3QpKSk7DQoNCgkJREJBY3Rpb24gYWN0aW9uUU1TUlFUID0gZGF0YWJhc2UudGFibGUoIlFNU1JRVCIpDQoJCQkJLmluZGV4KCIyMCIpDQoJCQkJLm1hdGNoaW5nKGV4cHJlc3Npb24pDQoJCQkJLnNlbGVjdGlvbigiUlRRUklEIiwgIlJUUVRTVCIsICJSVFNNU1oiLCAiUlRRVFJTIikNCgkJCQkuYnVpbGQoKTsNCgkJREJDb250YWluZXIgUU1TUlFUID0gYWN0aW9uUU1TUlFULmdldENvbnRhaW5lcigpOw0KCQlRTVNSUVQuc2V0KCJSVENPTk8iLCBpbnRDb25vKTsNCgkJUU1TUlFULnNldCgiUlRGQUNJIiwgcW1zcnFoRmFjaSk7DQoJCVFNU1JRVC5zZXQoIlJUSVROTyIsIG1pdHhJdG5vKTsNCgkJUU1TUlFULnNldCgiUlRCQU5PIiwgbWl0eEJhbm8pOw0KDQoJCWxvZ2dlci5kZWJ1ZyAoInJlYWQgc2luZ2xlIFFNU1JRVCBmb3IgRkFDSTogIiArIHFtc3JxaEZhY2kNCgkJCQkrICIgSVROTzogIiArIG1pdHhJdG5vDQoJCQkJKyAiIEJBTk86ICIgKyBtaXR4QmFubw0KCQkJCSk7DQoJCWFjdGlvblFNU1JRVC5yZWFkQWxsKFFNU1JRVCwgNCwgcW1zcnF0Rm9yRVhUNjAxKTsNCgl9DQoNCglDbG9zdXJlPD8+IHFtc3JxdEZvckVYVDYwMSA9IHsgREJDb250YWluZXIgUU1TUlFUIC0+DQoJCWxvZ2dlci5kZWJ1ZyAoIkNsb3N1cmU8Pz4gcW1zcnF0Rm9yRVhUNjAxIGFmdGVyIHN1Y2Nlc3NmdWxsIHJlYWQgb2YgUU1TUlFUIHJlY29yZCIpOw0KCQlxbXNycXRRcmlkID0gUU1TUlFULmdldCgiUlRRUklEIik7DQoJCXFtc3JxdFF0c3QgPSBRTVNSUVQuZ2V0KCJSVFFUU1QiKTsNCgkJcW1zcnF0U21zeiA9IFFNU1JRVC5nZXQoIlJUU01TWiIpOw0KCQlxbXNycXRRdHJzID0gUU1TUlFULmdldCgiUlRRVFJTIik7DQoNCgkJbG9nZ2VyLmRlYnVnKCJDbG9zdXJlPD8+IHFtc3JxdEZvckVYVDYwMSBjb21wYXJlIHZhbHVlcyBhcmUgcW1zcnF0UXJpZC9xbXNycWhRcmlkIHFtc3JxdFF0c3QvcW1zb3RzUXRzdCINCgkJCQkrICIgIiArIHFtc3JxdFFyaWQgKyAiLyIgKyBxbXNycWhRcmlkDQoJCQkJKyAiICIgKyBxbXNycXRRdHN0ICsgIi8iICsgcW1zb3RzUXRzdCk7DQoNCgkJaWYgKHFtc3JxdFFyaWQudHJpbSgpLmNvbnRlbnRFcXVhbHMocW1zcnFoUXJpZC50cmltKCkpDQoJCQkJJiYgIHFtc3JxdFF0c3QudHJpbSgpLmNvbnRlbnRFcXVhbHMocW1zb3RzUXRzdC50cmltKCkpKSB7DQoJCQlPcHRpb25hbDxEQkNvbnRhaW5lcj4gRVhUNjAxID0gcmVhZEVYVDYwMSgpOw0KCQkJaWYoIUVYVDYwMS5pc1ByZXNlbnQoKSl7DQoJCQkJbG9nZ2VyLmRlYnVnICgibm90IEVYVDYwMSBpc1ByZXNlbnQgPj4+ICBjYWxsIGFkZEVYVDYwMSBRUklEL0lUTk8vQkFOTyINCgkJCQkJCSsgcW1zcnFoUXJpZA0KCQkJCQkJKyAiIC8gIiArIG1pdHhJdG5vDQoJCQkJCQkrICIgLyAiICsgbWl0eEJhbm8pOw0KCQkJCWFkZEVYVDYwMSgpOw0KCQkJfSBlbHNlIHsNCgkJCQlsb2dnZXIuZGVidWcgKCJFWFQ2MDEgaXMgYWxyZWFkeSBleGlzdGluZyBRUklEL0lUTk8vQkFOTyINCgkJCQkJCSsgIiAiICAgKyAgcW1zcnFoUXJpZA0KCQkJCQkJKyAiIC8gIiArIG1pdHhJdG5vDQoJCQkJCQkrICIgLyAiICsgbWl0eEJhbm8pOw0KCQkJfQ0KCQl9DQoJfQ0KDQoJLyoqDQoJICogcmVhZEVYVDYwMSgpDQoJICoNCgkgKiByZXR1cm5zIHRoZSBFWFQ2MDEgcmVjb3JkIG9yIGFuIGVtcHR5IHJlY29yZCBmb3IgdGhlIGdpdmVuIGtleSBkYXRhDQoJICovDQoJcHJpdmF0ZSBPcHRpb25hbDxEQkNvbnRhaW5lcj4gcmVhZEVYVDYwMSgpIHsNCgkJbG9nZ2VyLmRlYnVnKCJzdGFydCByZWFkRVhUNjAxIHdpdGgga2V5IGpvYm46ICIgKyBzdHJKb2JuDQoJCQkJKyAiIHJpZG46ICIgKyBtaXR4Umlkbg0KCQkJCSsgIiByaWRsOiAiICsgbWl0eFJpZGwNCgkJCQkrICIgcmlkeDogIiArIG1pdHhSaWR4DQoJCQkJKyAiIHNwZWM6ICIgKyBxbXNycXNTcGVjDQoJCQkJKyAiIHFzZTA6ICIgKyBnZXRTdHJpbmdWYWx1ZShxbXNvdHNRc2UxLHFtc290c1FzZTIpDQoJCQkJKyAiIGl0bm86ICIgKyBtaXR4SXRubw0KCQkJCSsgIiBiYW5vOiAiICsgbWl0eEJhbm8NCgkJCQkrICIgcXRzdDogIiArIHFtc290c1F0c3QNCgkJCQkrICIgdHN0eTogIiArIHFtc290c1RzdHkNCgkJCQkpOw0KCQlEQkFjdGlvbiBhY3Rpb25FWFQ2MDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAxIikNCgkJCQkuaW5kZXgoIjAwIikNCgkJCQkuYnVpbGQoKTsNCgkJREJDb250YWluZXIgRVhUNjAxID0gYWN0aW9uRVhUNjAxLmdldENvbnRhaW5lcigpOw0KCQkvLyBLZXkgdmFsdWUgZm9yIHJlYWQNCgkJRVhUNjAxLnNldCgiRVhKT0JOIiwgc3RySm9ibik7DQoJCUVYVDYwMS5zZXQoIkVYQ09OTyIsIGludENvbm8pOw0KCQlFWFQ2MDEuc2V0KCJFWFJPUkMiLCBjb25zdFJPUkMzKTsNCgkJRVhUNjAxLnNldCgiRVhST1JOIiwgbWl0eFJpZG4pOw0KCQlFWFQ2MDEuc2V0KCJFWFJPUkwiLCBtaXR4UmlkbCk7DQoJCUVYVDYwMS5zZXQoIkVYUk9SWCIsIG1pdHhSaWR4KTsNCgkJRVhUNjAxLnNldCgiRVhTUEVDIiwgcW1zcnFzU3BlYyk7DQoJCUVYVDYwMS5zZXQoIkVYUVNFMCIsIGdldFN0cmluZ1ZhbHVlKHFtc290c1FzZTEscW1zb3RzUXNlMikpOw0KCQlFWFQ2MDEuc2V0KCJFWElUTk8iLCBtaXR4SXRubyk7DQoJCUVYVDYwMS5zZXQoIkVYQkFOTyIsIG1pdHhCYW5vKTsNCgkJRVhUNjAxLnNldCgiRVhRVFNUIiwgcW1zb3RzUXRzdCk7DQoJCUVYVDYwMS5zZXQoIkVYVFNUWSIsIHFtc290c1RzdHkpOw0KDQoJCS8vIFJlYWQNCgkJaWYgKGFjdGlvbkVYVDYwMS5yZWFkKEVYVDYwMSkpIHsNCgkJCWxvZ2dlci5kZWJ1ZygicmVhZEVYVDYwMSByZWNvcmQgaXMgZXhpc3RpbmciKTsNCgkJCXJldHVybiBPcHRpb25hbC5vZihFWFQ2MDEpOw0KCQl9DQoNCgkJbG9nZ2VyLmRlYnVnKCJyZWFkRVhUNjAxIHJlY29yZCBpcyBub3QgZXhpc3RpbmciKTsNCgkJcmV0dXJuIE9wdGlvbmFsLmVtcHR5KCk7DQoJfQ0KDQoJLyoqDQoJICogYWRkRVhUNjAxDQoJICoNCgkgKiBhZGQgYSBuZXcgcmVjb3JkIHRvIGZpbGUgRVhUNjAxDQoJICovDQoJcHJpdmF0ZSB2b2lkIGFkZEVYVDYwMSgpIHsNCgkJbG9nZ2VyLmRlYnVnKCJPdXRwdXRQcm9jZXNzR1lfQ01SIGFkZEVYVDYwMSIpOw0KCQlEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAxIikNCgkJCQkuaW5kZXgoIjAwIikNCgkJCQkuYnVpbGQoKTsNCgkJREJDb250YWluZXIgRVhUNjAxID0gYWN0aW9uLmNyZWF0ZUNvbnRhaW5lcigpOw0KDQoJCUVYVDYwMS5zZXQoIkVYSk9CTiIsIHN0ckpvYm4pOw0KCQlFWFQ2MDEuc2V0KCJFWENPTk8iLCBpbnRDb25vKTsNCgkJRVhUNjAxLnNldCgiRVhST1JDIiwgY29uc3RST1JDMyk7DQoJCUVYVDYwMS5zZXQoIkVYUk9STiIsIG1pdHhSaWRuKTsNCgkJRVhUNjAxLnNldCgiRVhST1JMIiwgbWl0eFJpZGwpOw0KCQlFWFQ2MDEuc2V0KCJFWFJPUlgiLCBtaXR4UmlkeCk7DQoJCUVYVDYwMS5zZXQoIkVYU1BFQyIsIHFtc3Jxc1NwZWMpOw0KCQlFWFQ2MDEuc2V0KCJFWFFTRTAiLCBnZXRTdHJpbmdWYWx1ZShxbXNvdHNRc2UxLHFtc290c1FzZTIpKTsNCgkJRVhUNjAxLnNldCgiRVhJVE5PIiwgbWl0eEl0bm8pOw0KCQlFWFQ2MDEuc2V0KCJFWEJBTk8iLCBtaXR4QmFubyk7DQoJCUVYVDYwMS5zZXQoIkVYUVRTVCIsIHFtc290c1F0c3QpOw0KCQlFWFQ2MDEuc2V0KCJFWFRTVFkiLCBxbXNvdHNUc3R5KTsNCgkJLy9ub24ga2V5IGZpZWxkcw0KCQlFWFQ2MDEuc2V0KCJFWFFURTAiLCBnZXRTdHJpbmdWYWx1ZShxbXNvdHNRdGUxLHFtc290c1F0ZTIpKTsNCgkJRVhUNjAxLnNldCgiRVhFVk1YIiwgcW1zb3RzRXZteCk7DQoJCXJvdW5kZWRQeG51bSA9IHJvdW5kZWRSZXN1bHQocW1zb3RzRGNjZCwgcW1zb3RzRXZteCk7DQoJCUVYVDYwMS5zZXQoIkVYU1ZNWCIsIGdldFN0cmluZ1ZhbHVlKHFtc290c0RjY2QsIHJvdW5kZWRQeG51bSkpOw0KCQlFWFQ2MDEuc2V0KCJFWEVWTU4iLCBxbXNvdHNFdm1uKTsNCgkJcm91bmRlZFB4bnVtID0gcm91bmRlZFJlc3VsdChxbXNvdHNEY2NkLCBxbXNvdHNFdm1uKTsNCgkJRVhUNjAxLnNldCgiRVhTVk1OIiwgZ2V0U3RyaW5nVmFsdWUocW1zb3RzRGNjZCwgcm91bmRlZFB4bnVtKSk7DQoJCUVYVDYwMS5zZXQoIkVYU01TWiIsIHFtc3JxdFNtc3opOw0KCQlFWFQ2MDEuc2V0KCJFWFNTU1oiLCBnZXRTdHJpbmdWYWx1ZShxbXNvdHNEY2NkLCBxbXNycXRTbXN6KSk7DQoJCUVYVDYwMS5zZXQoIkVYUVJJRCIsIHFtc3JxaFFyaWQpOw0KCQlFWFQ2MDEuc2V0KCJFWFFUUlMiLCBxbXNycXRRdHJzKTsNCgkJRVhUNjAxLnNldCgiRVhTVFJTIiwgZ2V0U3RyaW5nVmFsdWUocW1zb3RzRGNjZCwgcW1zcnF0UXRycykpOw0KCQlFWFQ2MDEuc2V0KCJFWERDQ0QiLCBxbXNvdHNEY2NkKTsNCgkJaWYgKHFtc3JxdFNtc3ogPiBxbXNycXRRdHJzDQoJCQkJJiYgIHFtc3JxdFNtc3ogIT0gMGQpIHsNCgkJCXJlc3VsdFF0cnMgPSBxbXNycXRTbXN6Ow0KCQkJcmVzdWx0UXRreiA9ICI8IjsNCgkJfSBlbHNlIHsNCgkJCXJlc3VsdFF0cnMgPSBxbXNycXRRdHJzOw0KCQkJcmVzdWx0UXRreiA9ICIgIjsNCgkJfQ0KCQlFWFQ2MDEuc2V0KCJFWFFUUk4iLCByZXN1bHRRdHJzKTsgLy8tDQoJCXJvdW5kZWRQeG51bSA9IHJvdW5kZWRSZXN1bHQocW1zb3RzRGNjZCwgcmVzdWx0UXRycyk7DQoJCUVYVDYwMS5zZXQoIkVYUVRSVCIsIGdldFN0cmluZ1ZhbHVlKHFtc290c0RjY2QsIHJvdW5kZWRQeG51bSkpOw0KCQlFWFQ2MDEuc2V0KCJFWFFUS1oiLCByZXN1bHRRdGt6KTsNCgkJLy9zdGF0aXN0aWNhbCBpbmZvcm1hdGlvbg0KCQlFWFQ2MDEuc2V0KCJFWENISUQiLCBwcm9ncmFtLmdldFVzZXIoKSk7DQoJCUVYVDYwMS5zZXQoIkVYQ0hOTyIsIDEpOw0KDQoJCUVYVDYwMS5zZXQoIkVYUkdEVCIsIHJlZ2RhdGUpOw0KCQlFWFQ2MDEuc2V0KCJFWExNRFQiLCByZWdkYXRlKTsNCgkJRVhUNjAxLnNldCgiRVhSR1RNIiwgcmVndGltZSk7DQoJCWFjdGlvbi5pbnNlcnQoRVhUNjAxKTsNCgkJbWFpbnRhaW5BcnI2MDAoImFkZCIsIG1pdHhSaWRuLCBtaXR4UmlkbCwgbWl0eFJpZHgsIG1pdHhJdG5vLCBtaXR4QmFubyk7DQoJfQ0KDQoJLyoqIG1haW50YWluIGFycmF5IHVzZWQgdG8gc3RvcmUgZnJvbSBEQiBnb3R0ZW4gZGF0YQ0KCSAqICBpbnB1dCAgcGFyYW1ldGVyDQoJICogCUBwYXJhbQlvcGVyYXRpb24gLSBhbGxvd2VkIGFyZSAiY2xlYXIiLCAiZXhpc3QiIGFuZCAiYWRkIg0KCSAqIAlAcGFyYW0gIGRldGFpbGVkIGZpZWxkIGluZm9ybWF0aW9uDQoJICovDQoJYm9vbGVhbiBtYWludGFpbkFycmF5cyhTdHJpbmcgb3BlcmF0aW9uLA0KCQkJU3RyaW5nIHJpZG4sDQoJCQlpbnQgcmlkbCwNCgkJCWludCByaWR4LA0KCQkJU3RyaW5nIHdobG8sDQoJCQlTdHJpbmcgaXRubywNCgkJCVN0cmluZyBiYW5vKSB7DQoNCgkJbG9nZ2VyLmRlYnVnKCJtYWludGFpbkFycmF5cyBPcGVyYXRpb246ICIgKyBvcGVyYXRpb24NCgkJCQkrICIgcmlkbjogIiAgKyByaWRuDQoJCQkJKyAiIHJpZGw6ICIgKyBTdHJpbmcudmFsdWVPZihyaWRsKQ0KCQkJCSsgIiByaWR4OiAiICsgU3RyaW5nLnZhbHVlT2YocmlkeCkNCgkJCQkrICIgd2hsbzogIiArIHdobG8NCgkJCQkrICIgaXRubzogIiArIGl0bm8NCgkJCQkrICIgYmFubzogIiArIGJhbm8pOw0KDQoJCWlmIChvcGVyYXRpb24gPT0gImNsZWFyIikgew0KCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJNYXg7IGkrKykgew0KCQkJCWFyclJpZG5baV0gPSAiIjsNCgkJCQlhcnJSaWRsW2ldID0gMDsNCgkJCQlhcnJSaWR4W2ldID0gMDsNCgkJCQlhcnJXaGxvW2ldID0gIiI7DQoJCQkJYXJySXRub1tpXSA9ICIiOw0KCQkJCWFyckJhbm9baV0gPSAiIjsNCgkJCQlhcnJGYWNpW2ldID0gIiI7DQoJCQkJYXJyUXJpZFtpXSA9IDA7DQoJCQl9DQoJCQlyZXR1cm4gdHJ1ZTsNCgkJfQ0KDQoJCWlmIChvcGVyYXRpb24gPT0gImFkZCIpIHsNCgkJCWlmIChyaWRuLmlzRW1wdHkoKSkgew0KCQkJCWxvZ2dlci5kZWJ1ZygibWFpbnRhaW5BcnJheXMgcmlkbiBpcyBlbXB0eSIpOw0KCQkJCXJldHVybiB0cnVlOw0KCQkJfQ0KCQkJZm9yIChpbnQgeCA9IDA7IHggPCBhcnJNYXg7IHgrKykgew0KCQkJCWlmIChhcnJSaWRuW3hdLmNvbnRlbnRFcXVhbHMocmlkbi50cmltKCkpDQoJCQkJCQkmJiAgYXJyV2hsb1t4XS5jb250ZW50RXF1YWxzKHdobG8udHJpbSgpKQ0KCQkJCQkJJiYgIGFyclJpZGxbeF0gPT0gcmlkbA0KCQkJCQkJJiYgIGFyclJpZG5beF0gPT0gcmlkbg0KCQkJCQkJJiYgIGFyckl0bm9beF0uY29udGVudEVxdWFscyhpdG5vLnRyaW0oKSkNCgkJCQkJCSYmICBhcnJCYW5vW3hdLmNvbnRlbnRFcXVhbHMoYmFuby50cmltKCkpKSB7DQoJCQkJCXJldHVybiB0cnVlOw0KCQkJCX0NCgkJCQlpZiAoYXJyUmlkblt4XS5pc0JsYW5rKCkNCgkJCQkJCSYmICBhcnJXaGxvW3hdLmlzQmxhbmsoKQ0KCQkJCQkJJiYgIGFyclJpZGxbeF0gPT0gMGwNCgkJCQkJCSYmICBhcnJSaWR4W3hdID09IDBsKSB7DQoJCQkJCWFyclJpZG5beF0gPSByaWRuLnRyaW0oKTsNCgkJCQkJYXJyV2hsb1t4XSA9IHdobG8udHJpbSgpOw0KCQkJCQlhcnJSaWRsW3hdID0gcmlkbDsNCgkJCQkJYXJyUmlkeFt4XSA9IHJpZHg7DQoJCQkJCWFyckl0bm9beF0gPSBpdG5vLnRyaW0oKTsNCgkJCQkJYXJyQmFub1t4XSA9IGJhbm8udHJpbSgpOw0KCQkJCQlsb2dnZXIuZGVidWcoIm1haW50YWluQXJyYXlzIEFERCBmb3IgUklETi9SSURML1JJRFgvV0hMTy9JVE5PL0JBTk86ICINCgkJCQkJCQkrIHJpZG4udHJpbSgpICsgJy8nDQoJCQkJCQkJKyBTdHJpbmcudmFsdWVPZihyaWRsKSArICcvJw0KCQkJCQkJCSsgU3RyaW5nLnZhbHVlT2YocmlkeCkgKyAnLycNCgkJCQkJCQkrIHdobG8gKyAnLycNCgkJCQkJCQkrIGl0bm8gKyAnLycNCgkJCQkJCQkrIGJhbm8gKyIgZXhlY3V0ZWQuIiApOw0KCQkJCQlyZXR1cm4gdHJ1ZTsNCgkJCQl9DQoJCQl9DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgl9DQoNCgkvKiogbWFpbnRhaW4gYXJyYXkgdXNlZCB0byBzdG9yZSBmcm9tIERCIGdvdHRlbiBkYXRhDQoJICogIGlucHV0ICBwYXJhbWV0ZXINCgkgKiAJQHBhcmFtCW9wZXJhdGlvbiAtIGFsbG93ZWQgYXJlICJjbGVhciIsICJleGlzdCIgYW5kICJhZGQiDQoJICogCUBwYXJhbSAgZGV0YWlsZWQgZmllbGQgaW5mb3JtYXRpb24NCgkgKi8NCglib29sZWFuIG1haW50YWluQXJyNjAwKFN0cmluZyBvcGVyYXRpb24sDQoJCQlTdHJpbmcgcmlkbiwNCgkJCWludCByaWRsLA0KCQkJaW50IHJpZHgsDQoJCQlTdHJpbmcgaXRubywNCgkJCVN0cmluZyBiYW5vKSB7DQoNCgkJbG9nZ2VyLmRlYnVnKCJtYWludGFpbkFycjYwMCBPcGVyYXRpb246ICIgKyBvcGVyYXRpb24NCgkJCQkrICIgcmlkbjogIiAgKyByaWRuDQoJCQkJKyAiIHJpZGw6ICIgKyBTdHJpbmcudmFsdWVPZihyaWRsKQ0KCQkJCSsgIiByaWR4OiAiICsgU3RyaW5nLnZhbHVlT2YocmlkeCkNCgkJCQkrICIgaXRubzogIiArIGl0bm8NCgkJCQkrICIgYmFubzogIiArIGJhbm8pOw0KDQoJCWlmIChvcGVyYXRpb24gPT0gImNsZWFyIikgew0KCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJNYXg7IGkrKykgew0KCQkJCWFycjBSaWRuW2ldID0gIiI7DQoJCQkJYXJyMFJpZGxbaV0gPSAwOw0KCQkJCWFycjBSaWR4W2ldID0gMDsNCgkJCQlhcnIwSXRub1tpXSA9ICIiOw0KCQkJCWFycjBCYW5vW2ldID0gIiI7DQoJCQl9DQoJCQlyZXR1cm4gdHJ1ZTsNCgkJfQ0KDQoJCWlmIChvcGVyYXRpb24gPT0gImFkZCIpIHsNCgkJCWlmIChyaWRuLmlzRW1wdHkoKSkgew0KCQkJCWxvZ2dlci5kZWJ1ZygibWFpbnRhaW5BcnI2MDAgcmlkbiBpcyBlbXB0eSIpOw0KCQkJCXJldHVybiB0cnVlOw0KCQkJfQ0KCQkJZm9yIChpbnQgeCA9IDA7IHggPCBhcnJNYXg7IHgrKykgew0KCQkJCWlmIChhcnIwUmlkblt4XS5jb250ZW50RXF1YWxzKHJpZG4udHJpbSgpKQ0KCQkJCQkJJiYgIGFycjBSaWRsW3hdID09IHJpZGwNCgkJCQkJCSYmICBhcnIwUmlkblt4XSA9PSByaWRuDQoJCQkJCQkmJiAgYXJyMEl0bm9beF0uY29udGVudEVxdWFscyhpdG5vLnRyaW0oKSkNCgkJCQkJCSYmICBhcnIwQmFub1t4XS5jb250ZW50RXF1YWxzKGJhbm8udHJpbSgpKSkgew0KCQkJCQlsb2dnZXIuZGVidWcoIm1haW50YWluQXJyNjAwIGNvbnRlbnRFcXVhbHMgYXJyMFJyaWRuL3JpZGwvaXRuby9iYW5vOiINCgkJCQkJCQkrIGFycjBSaWRuW3hdDQoJCQkJCQkJKyBhcnIwUmlkbFt4XQ0KCQkJCQkJCSsgYXJyMEl0bm9beF0NCgkJCQkJCQkrIGFycjBCYW5vW3hdKTsNCgkJCQkJcmV0dXJuIHRydWU7DQoJCQkJfQ0KCQkJCWlmIChhcnIwUmlkblt4XS5pc0JsYW5rKCkNCgkJCQkJCSYmICBhcnIwUmlkbFt4XSA9PSAwbA0KCQkJCQkJJiYgIGFycjBSaWR4W3hdID09IDBsKSB7DQoJCQkJCWFycjBSaWRuW3hdID0gcmlkbi50cmltKCk7DQoJCQkJCWFycjBSaWRsW3hdID0gcmlkbDsNCgkJCQkJYXJyMFJpZHhbeF0gPSByaWR4Ow0KCQkJCQlhcnIwSXRub1t4XSA9IGl0bm8udHJpbSgpOw0KCQkJCQlhcnIwQmFub1t4XSA9IGJhbm8udHJpbSgpOw0KCQkJCQlsb2dnZXIuZGVidWcoIm1haW50YWluQXJyNjAwIGFkZCBhcnIwUnJpZG4vcmlkbC9pdG5vL2Jhbm86Ig0KCQkJCQkJCSsgYXJyMFJpZG5beF0NCgkJCQkJCQkrIGFycjBSaWRsW3hdDQoJCQkJCQkJKyBhcnIwSXRub1t4XQ0KCQkJCQkJCSsgYXJyMEJhbm9beF0pOw0KCQkJCQlyZXR1cm4gdHJ1ZTsNCgkJCQl9DQoJCQl9DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgl9DQoJDQoJcHVibGljIGRvdWJsZSByb3VuZGVkUmVzdWx0KGludCBkY2NkLCBkb3VibGUgZG91YmxlUHhudW0pIHsNCgkJbG9nZ2VyLmRlYnVnKCJyb3VuZGVkUmVzdWx0IFN0YXJ0IGRjY2QvZG91YmxlUHhudW06ICIgKyBkY2NkICsgIi8iKyBkb3VibGVQeG51bS50b1N0cmluZygpKTsNCgkJDQoJCWRvdWJsZSBkID0gTWF0aC5wb3coMTAsIGRjY2QpOw0KCQlkb3VibGUgcmV0dXJuUHhudW0gPSBNYXRoLnJvdW5kKGRvdWJsZVB4bnVtICogZCkgLyBkOw0KCQkNCgkJbG9nZ2VyLmRlYnVnKCJyb3VuZGVkUmVzdWx0IHJlc3VsdCBkY2NkL2RvdWJsZVB4bnVtOiAiICsgZGNjZCArICIvIisgcmV0dXJuUHhudW0udG9TdHJpbmcoKSk7DQoJCXJldHVybiByZXR1cm5QeG51bTsNCgl9DQoJDQoNCgkvKioNCgkgKiAgIGdldFN0cmluZ1ZhbHVlIHRvIHJldHVybiBudW1lcmljIGRpZ2l0cyB3aXRoIGxlYWRpbmcgemVybw0KCSAqLw0KCXB1YmxpYyBTdHJpbmcgZ2V0U3RyaW5nVmFsdWUgKGludCBlMVZhbHVlLCBpbnQgZTJWYWx1ZSkgew0KCQlTdHJpbmcgc3RyRmllbGQxID0gU3RyaW5nLnZhbHVlT2YoZTFWYWx1ZSkudHJpbSgpOw0KCQlTdHJpbmcgc3RyRmllbGQyID0gU3RyaW5nLnZhbHVlT2YoZTJWYWx1ZSkudHJpbSgpOw0KCQlTdHJpbmcgc3RyUmVzdWx0ID0gIiI7DQoNCgkJd2hpbGUoc3RyRmllbGQxLmxlbmd0aCgpIDwgOCl7DQoJCQlzdHJGaWVsZDEgID0gIjAiICsgc3RyRmllbGQxOw0KCQl9DQoJCXdoaWxlKHN0ckZpZWxkMi5sZW5ndGgoKSA8IDQpew0KCQkJc3RyRmllbGQyICA9ICIwIiArIHN0ckZpZWxkMjsNCgkJfQ0KDQoJCXN0clJlc3VsdCA9IHN0ckZpZWxkMSArIHN0ckZpZWxkMjsNCg0KCQlyZXR1cm4gc3RyUmVzdWx0Ow0KCX0NCg0KCS8qKg0KCSAqICAgZ2V0U3RyaW5nVmFsdWUgZm9yIGdpdmVuIERDQ0QgYW5kIFBYTlVNDQoJICovDQoJcHVibGljIFN0cmluZyBnZXRTdHJpbmdWYWx1ZShpbnQgZGNjZCwgZG91YmxlIHB4bnVtKSB7DQoJCQ0KDQoJCWlmIChkY2NkID4gNikgew0KCQkJZGNjZCA9IDY7DQoJCX0NCg0KCQlkb3VibGUgZG91YmxlUHhudW0gPSBweG51bTsNCgkJaW50IGludFB4bnVtID0gKGludCkgcHhudW07DQoJCVN0cmluZyByZXR1cm5WYWwgPSAiIjsNCg0KCQlpZiAoZGNjZCA9PSAxKSB7DQoJCQlkb3VibGVQeG51bSA9IERvdWJsZS5wYXJzZURvdWJsZShkZjEuZm9ybWF0KGRvdWJsZVB4bnVtKSk7DQoJCX0NCgkJaWYgKGRjY2QgPT0gMikgew0KCQkJZG91YmxlUHhudW0gPSBEb3VibGUucGFyc2VEb3VibGUoZGYyLmZvcm1hdChkb3VibGVQeG51bSkpOw0KCQl9DQoJCWlmIChkY2NkID09IDMpIHsNCgkJCWRvdWJsZVB4bnVtID0gRG91YmxlLnBhcnNlRG91YmxlKGRmMy5mb3JtYXQoZG91YmxlUHhudW0pKTsNCgkJfQ0KCQlpZiAoZGNjZCA9PSA0KSB7DQoJCQlkb3VibGVQeG51bSA9IERvdWJsZS5wYXJzZURvdWJsZShkZjQuZm9ybWF0KGRvdWJsZVB4bnVtKSk7DQoJCX0NCgkJaWYgKGRjY2QgPT0gNSkgew0KCQkJZG91YmxlUHhudW0gPSBEb3VibGUucGFyc2VEb3VibGUoZGY1LmZvcm1hdChkb3VibGVQeG51bSkpOw0KCQl9DQoJCWlmIChkY2NkID09IDYpIHsNCgkJCWRvdWJsZVB4bnVtID0gRG91YmxlLnBhcnNlRG91YmxlKGRmNi5mb3JtYXQoZG91YmxlUHhudW0pKTsNCgkJfQ0KCQlpZiAoZGNjZCAhPSAwKSB7DQoJCQlyZXR1cm5WYWwgPSAgU3RyaW5nLnZhbHVlT2YoZG91YmxlUHhudW0pLnRyaW0oKTsNCgkJfSBlbHNlIHsNCgkJCXJldHVyblZhbCA9ICBTdHJpbmcudmFsdWVPZihpbnRQeG51bSkudHJpbSgpOw0KCQl9DQoJCWxvZ2dlci5kZWJ1ZygiZ2V0U3RyaW5nVmFsdWUgZGNjZDogJHtkY2NkfSBweG51bSA9ICR7cHhudW19IHJldHVyblZhbCA9ICR7cmV0dXJuVmFsfSIgKTsNCgkJcmV0dXJuIHJldHVyblZhbDsNCgl9DQoNCgkvKioNCgkgKiAgUmVtb3ZlIG5vdCBsb25nZXIgdXNlIGRhdGEgZnJvbSBFWFQ2MDAgYW5kIEVYVDYwMQ0KCSAqICAtIGJhc2VkIG9uIHRoZSByZWNvcmQgY3JlYXRpb24gZGF0ZQ0KCSAqLw0KCXZvaWQgcmVvcmdFWFQ2MDEoKSB7DQoJCWZvciAoaSA9IDA7IGkgPCAxMDsgaSsrICkgew0KCQkJYXJySk9CTltpXSA9ICIiOw0KCQl9DQoJCWxvZ2dlci5kZWJ1ZygiU0NFX0JhdGNoX0NSRVhUUFJUX1FNUzYwMVBGL3Jlb3JnRVhUNjAxIENvbm86ICIgKyBpbnRDb25vKTsNCgkJREJBY3Rpb24gYWN0aW9uID0gZGF0YWJhc2UudGFibGUoIkVYVDYwMSIpDQoJCQkJLmluZGV4KCIxMCIpDQoJCQkJLnNlbGVjdGlvbigiRVhSR0RUIiwgIkVYSk9CTiIpDQoJCQkJLmJ1aWxkKCk7DQoJCURCQ29udGFpbmVyIEVYVDYwMSA9IGFjdGlvbi5nZXRDb250YWluZXIoKTsNCg0KCQlFWFQ2MDEuc2V0KCJFWENPTk8iLCBpbnRDb25vKTsNCg0KCQlhY3Rpb24ucmVhZEFsbChFWFQ2MDEsIDEsIHNlbGVjdERlbGV0ZUpvYm4pOw0KDQoJCWZvciAoaSA9IDA7IGkgPCAxMDsgaSsrICkgew0KCQkJaWYgKCFhcnJKT0JOW2ldLmlzRW1wdHkoKSkgew0KCQkJCWxvZ2dlci5kZWJ1ZygiU0NFX0JhdGNoX0NSRVhUUFJUX1FNUzYwMVBGL2RlbGV0ZUVYVDYyIGpvYm46ICIgKyBhcnJKT0JOW2ldKTsNCgkJCQlkZWxldGVFWFQ2MDBfSk9CTihhcnJKT0JOW2ldKTsNCgkJCQlkZWxldGVFWFQ2MDFfSk9CTihhcnJKT0JOW2ldKTsNCgkJCX0NCgkJfQ0KCX0NCg0KCUNsb3N1cmU8Pz4gIHNlbGVjdERlbGV0ZUpvYm4gID0geyBEQkNvbnRhaW5lciBleHQgLT4NCgkJU3RyaW5nIGpvYm4gPSBleHQuZ2V0KCJFWEpPQk4iKTsNCgkJaW50IHJnZHQgPSBleHQuZ2V0KCJFWFJHRFQiKTsNCgkJbG9nZ2VyLmRlYnVnKCJTQ0VfQmF0Y2hfQ1JFWFRQUlRfUU1TNjAxUEYvc2VsZWN0RGVsZXRlSm9ibiBqb2JuOiAiICsgam9ibiArICIgcmdkdDogIiArIHJnZHQpOw0KCQlpZiAocmdkdCA8IHJlZ2RhdGUpIHsNCgkJCWZvciAoaSA9IDA7IGkgPCAxMDsgaSsrICkgew0KCQkJCWlmIChhcnJKT0JOW2ldLmNvbnRlbnRFcXVhbHMoam9ibikpICB7DQoJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCQlpZiAoYXJySk9CTltpXS5pc0VtcHR5KCkpIHsNCgkJCQkJYXJySk9CTltpXSA9IChqb2JuKTsNCgkJCQkJYnJlYWs7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KDQoJLyoqDQoJICogZGVsZXRlRVhUNjAwX1JJRE4NCgkgKg0KCSAqIGRlbGV0ZSBub3QgbG9uZ2VyIHVzZWQgZGF0YSBmcm9tIGR5bmFtaWMgdGFibGUgRVhUNjAwLCBzZWxlY3RlZCBieSBSSUROLCBwb3NpdGlvbiBpbmZvcm1hdGlvbiBhbmQgaXRlbQ0KCSAqLw0KCXZvaWQgZGVsZXRlRVhUNjAwX1JJRE4oU3RyaW5nIHJvcm4sIGludCByb3JsLCBpbnQgcm9yeCwgU3RyaW5nIGl0bm8sIFN0cmluZyBiYW5vKSB7DQoJCWxvZ2dlci5kZWJ1ZygiU0NFX0JhdGNoX0NSRVhUUFJUX1FNUzYwMVBGL2RlbGV0ZUVYVDYwMCByb3JuOiAiICsgcm9ybg0KCQkJCSsgIiByb3JsOiAiICsgcm9ybA0KCQkJCSsgIiByb3J4OiAiICsgcm9yeA0KCQkJCSsgIiBpdG5vOiAiICsgaXRubw0KCQkJCSsgIiBiYW5vOiAiICsgYmFubyk7DQoJCW1pdHhJdG5vID0gaXRubzsNCgkJbWl0eEJhbm8gPSBiYW5vOw0KCQlEQkFjdGlvbiBhY3Rpb25FWFQ2MDAgPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAwIikNCgkJCQkuaW5kZXgoIjAwIikNCgkJCQkuc2VsZWN0aW9uKCJFWElUTk8iLCAiRVhCQU5PIikNCgkJCQkuYnVpbGQoKTsNCgkJREJDb250YWluZXIgRVhUNjAwID0gYWN0aW9uRVhUNjAwLmdldENvbnRhaW5lcigpOw0KCQlFWFQ2MDAuc2V0KCJFWENPTk8iLCBpbnRDb25vKTsNCgkJRVhUNjAwLnNldCgiRVhST1JDIiwgY29uc3RST1JDMyk7DQoJCUVYVDYwMC5zZXQoIkVYUk9STiIsIHJvcm4pOw0KCQlFWFQ2MDAuc2V0KCJFWFJPUkwiLCByb3JsKTsNCgkJRVhUNjAwLnNldCgiRVhST1JYIiwgcm9yeCk7DQoJCUVYVDYwMC5zZXQoIkVYSVROTyIsIGl0bm8pOw0KCQlFWFQ2MDAuc2V0KCJFWEJBTk8iLCBiYW5vKTsNCg0KCQlhY3Rpb25FWFQ2MDAucmVhZEFsbExvY2soRVhUNjAwLCA3LCBkZWxldGVDYWxsQmFjazYwMCk7DQoJfQ0KDQoJQ2xvc3VyZTw/PiBkZWxldGVDYWxsQmFjazYwMCA9IHsgTG9ja2VkUmVzdWx0IEVYVDYwMCAtPg0KCQlsb2dnZXIuZGVidWcoImRlbGV0ZUNhbGxCYWNrIEVYVDYwMSBJVE5PL0JBTk86ICIgKyBFWFQ2MDAuZ2V0KCJFWElUTk8iKSArICIgLyAiICsgRVhUNjAwLmdldCgiRVhCQU5PIikpOw0KCQlFWFQ2MDAuZGVsZXRlKCk7DQoJfQ0KDQoJLyoqDQoJICogZGVsZXRlRVhUNjAwX1JJRE4NCgkgKg0KCSAqIGRlbGV0ZSBub3QgbG9uZ2VyIHVzZWQgZGF0YSBmcm9tIGR5bmFtaWMgdGFibGUgRVhUNjAwLCBzZWxlY3RlZCBieSBSSURODQoJICovDQoJdm9pZCBkZWxldGVFWFQ2MDBfUklETihTdHJpbmcgcm9ybikgew0KCQlEQkFjdGlvbiBhY3Rpb25FWFQ2MDAgPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAwIikNCgkJCQkuaW5kZXgoIjAwIikNCgkJCQkuc2VsZWN0aW9uKCJFWEpPQk4iKQ0KCQkJCS5idWlsZCgpOw0KCQlEQkNvbnRhaW5lciBFWFQ2MDAgPSBhY3Rpb25FWFQ2MDAuZ2V0Q29udGFpbmVyKCk7DQoJCUVYVDYwMC5zZXQoIkVYQ09OTyIsIGludENvbm8pOw0KCQlFWFQ2MDAuc2V0KCJFWFJPUkMiLCBjb25zdFJPUkMzKTsNCgkJRVhUNjAwLnNldCgiRVhST1JOIiwgcm9ybik7DQoNCgkJYWN0aW9uRVhUNjAwLnJlYWRBbGxMb2NrKEVYVDYwMCwgMywgZGVsZXRlQ2FsbEJhY2s2MDBfSm9ibik7DQoJfQ0KDQoJQ2xvc3VyZTw/PiBkZWxldGVDYWxsQmFjazYwMF9Kb2JuID0geyBMb2NrZWRSZXN1bHQgRVhUNjAwIC0+DQoJCWNvbXBhcmVWYWx1ZSA9IEVYVDYwMC5nZXQoIkVYSk9CTiIpOw0KCQljb21wYXJlUmVzdWx0ID0gc3RySm9ibi50cmltKCkuY29tcGFyZVRvKGNvbXBhcmVWYWx1ZS50cmltKCkpOw0KCQlpZiAoY29tcGFyZVJlc3VsdCAhPSAwKSAgew0KCQkJbG9nZ2VyLmRlYnVnKCJkZWxldGVDYWxsQmFjayBFWFQ2MDFfSm9ibjogIiArIGNvbXBhcmVWYWx1ZSk7DQoJCQlsb2dnZXIuZGVidWcoImRlbGV0ZUNhbGxCYWNrIGNvbXBhcmVSZXN1bHQgRVhKT0JOIHZzIHN0ckpvYm4gIT0gMCAiICsgRVhUNjAwLmdldCgiRVhKT0JOIikgKyAiIC8gIiArIHN0ckpvYm4pOw0KCQkJRVhUNjAwLmRlbGV0ZSgpOw0KCQl9DQoJfQ0KDQoJLyoqDQoJICogZGVsZXRlRVhUNjAxX1JJRE4NCgkgKg0KCSAqIGRlbGV0ZSBub3QgbG9uZ2VyIHVzZWQgZGF0YSBmcm9tIGR5bmFtaWMgdGFibGUgRVhUNjAxLCBzZWxlY3RlZCBieSBSSUROLCBwb3NpdGlvbiBpbmZvcm1hdGlvbiBhbmQgaXRlbQ0KCSAqLw0KCXZvaWQgZGVsZXRlRVhUNjAxX1JJRE4oU3RyaW5nIHJvcm4sIGludCByb3JsLCBpbnQgcm9yeCwgU3RyaW5nIGl0bm8sIFN0cmluZyBiYW5vKSB7DQoJCWxvZ2dlci5kZWJ1ZygiU0NFX0JhdGNoX0NSRVhUUFJUX1FNUzYwMVBGL2RlbGV0ZUVYVDYwMSByb3JuOiAiICsgcm9ybg0KCQkJCSsgIiByb3JsOiAiICsgcm9ybA0KCQkJCSsgIiByb3J4OiAiICsgcm9yeA0KCQkJCSsgIiBpdG5vOiAiICsgaXRubw0KCQkJCSsgIiBiYW5vOiAiICsgYmFubyk7DQoJCW1pdHhJdG5vID0gaXRubzsNCgkJbWl0eEJhbm8gPSBiYW5vOw0KCQlEQkFjdGlvbiBhY3Rpb25FWFQ2MDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAxIikNCgkJCQkuaW5kZXgoIjIwIikNCgkJCQkuYnVpbGQoKTsNCgkJREJDb250YWluZXIgRVhUNjAxID0gYWN0aW9uRVhUNjAxLmdldENvbnRhaW5lcigpOw0KCQlFWFQ2MDEuc2V0KCJFWENPTk8iLCBpbnRDb25vKTsNCgkJRVhUNjAxLnNldCgiRVhST1JDIiwgY29uc3RST1JDMyk7DQoJCUVYVDYwMS5zZXQoIkVYUk9STiIsIHJvcm4pOw0KCQlFWFQ2MDEuc2V0KCJFWFJPUkwiLCByb3JsKTsNCgkJRVhUNjAxLnNldCgiRVhST1JYIiwgcm9yeCk7DQoJCUVYVDYwMS5zZXQoIkVYSVROTyIsIGl0bm8pOw0KCQlFWFQ2MDEuc2V0KCJFWEJBTk8iLCBiYW5vKTsNCgkJYWN0aW9uRVhUNjAxLnJlYWRBbGxMb2NrKEVYVDYwMSwgNywgZGVsZXRlQ2FsbEJhY2s2MDEpOw0KCX0NCg0KDQoNCglDbG9zdXJlPD8+IGRlbGV0ZUNhbGxCYWNrNjAxID0geyBMb2NrZWRSZXN1bHQgRVhUNjAxIC0+DQoJCWxvZ2dlci5kZWJ1ZygiIGRlbGV0ZUNhbGxCYWNrIEVYVDYwMSBJVE5POiAiICsgRVhUNjAxLmdldCgiRVhJVE5PIikpOw0KCQlFWFQ2MDEuZGVsZXRlKCk7DQoJfQ0KDQoJLyoqDQoJICogZGVsZXRlRVhUNjAxX1JJRE4NCgkgKg0KCSAqIGRlbGV0ZSBub3QgbG9uZ2VyIHVzZWQgZGF0YSBmcm9tIGR5bmFtaWMgdGFibGUgRVhUNjAxLCBzZWxlY3RlZCBieSBSSURODQoJICovDQoJdm9pZCBkZWxldGVFWFQ2MDFfUklETihTdHJpbmcgcm9ybikgew0KCQlsb2dnZXIuZGVidWcoIlNDRV9CYXRjaF9DUkVYVFBSVF9RTVM2MDFQRi9kZWxldGVFWFQ2MDEgcm9ybjogIiArIHJvcm4pOw0KCQlEQkFjdGlvbiBhY3Rpb25FWFQ2MDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAxIikNCgkJCQkuaW5kZXgoIjAwIikNCgkJCQkuc2VsZWN0aW9uKCJFWEpPQk4iKQ0KCQkJCS5idWlsZCgpOw0KCQlEQkNvbnRhaW5lciBFWFQ2MDEgPSBhY3Rpb25FWFQ2MDEuZ2V0Q29udGFpbmVyKCk7DQoJCUVYVDYwMS5zZXQoIkVYQ09OTyIsIGludENvbm8pOw0KCQlFWFQ2MDEuc2V0KCJFWFJPUkMiLCBjb25zdFJPUkMzKTsNCgkJRVhUNjAxLnNldCgiRVhST1JOIiwgcm9ybik7DQoJCWFjdGlvbkVYVDYwMS5yZWFkQWxsTG9jayhFWFQ2MDEsIDMsIGRlbGV0ZUNhbGxCYWNrNjAxX0pvYm4pOw0KCX0NCg0KDQoNCglDbG9zdXJlPD8+IGRlbGV0ZUNhbGxCYWNrNjAxX0pvYm4gPSB7IExvY2tlZFJlc3VsdCBFWFQ2MDEgLT4NCgkJbG9nZ2VyLmRlYnVnKCIgZGVsZXRlQ2FsbEJhY2sgRVhUNjAxIElUTk86ICIgKyBFWFQ2MDEuZ2V0KCJFWElUTk8iKSk7DQoJCWNvbXBhcmVWYWx1ZSA9IEVYVDYwMS5nZXQoIkVYSk9CTiIpOw0KCQljb21wYXJlUmVzdWx0ID0gc3RySm9ibi50cmltKCkuY29tcGFyZVRvKGNvbXBhcmVWYWx1ZS50cmltKCkpOw0KDQoJCWlmIChjb21wYXJlUmVzdWx0ICE9IDApICB7DQoJCQlsb2dnZXIuZGVidWcoImRlbGV0ZUNhbGxCYWNrX0pvYm46ICIgKyBjb21wYXJlVmFsdWUpOw0KCQkJRVhUNjAxLmRlbGV0ZSgpOw0KCQl9DQoJfQ0KDQoJLyoqDQoJICogZGVsZXRlRVhUNjAwX0pPQk4NCgkgKg0KCSAqIGRlbGV0ZSBub3QgbG9uZ2VyIHVzZWQgZGF0YSBmcm9tIGR5bmFtaWMgdGFibGUgRVhUNjAwLCBzZWxlY3RlZCBieSBKT0JODQoJICovDQoJdm9pZCBkZWxldGVFWFQ2MDBfSk9CTihTdHJpbmcgam9ibikgew0KCQlsb2dnZXIuZGVidWcoIk91dHB1dFByb2Nlc3NHWV9DTVIvZGVsZXRlRVhUNjAwIEpPQk46ICIgK2pvYm4pOw0KCQlEQkFjdGlvbiBxdWVyeTEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAwIikNCgkJCQkuaW5kZXgoIjEwIikNCgkJCQkuc2VsZWN0aW9uKCJFWElUTk8iLCAiRVhCQU5PIikNCgkJCQkuYnVpbGQoKTsNCg0KCQlEQkNvbnRhaW5lciBjb250YWluZXIxID0gcXVlcnkxLmdldENvbnRhaW5lcigpOw0KCQljb250YWluZXIxLnNldCgiRVhDT05PIiwgaW50Q29ubyk7DQoJCWNvbnRhaW5lcjEuc2V0KCJFWEpPQk4iLCBqb2JuKTsNCgkJcXVlcnkxLnJlYWRBbGxMb2NrKGNvbnRhaW5lcjEsIDIsIGRlbGV0ZUNhbGxCYWNrMSk7DQoJfQ0KDQoNCgkvKioNCgkgKiBkZWxldGVFWFQ2MDFfSk9CTg0KCSAqDQoJICogZGVsZXRlIG5vdCBsb25nZXIgdXNlZCBkYXRhIGZyb20gZHluYW1pYyB0YWJsZSBFWFQ2MDEsIHNlbGVjdGVkIGJ5IEpPQk4NCgkgKi8NCgl2b2lkIGRlbGV0ZUVYVDYwMV9KT0JOKFN0cmluZyBqb2JuKSB7DQoJCWxvZ2dlci5kZWJ1ZygiT3V0cHV0UHJvY2Vzc0dZX0NNUi9kZWxldGVFWFQ2MDEgSk9CTjogIiArIGpvYm4pOw0KCQlEQkFjdGlvbiBxdWVyeTEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNjAxIikNCgkJCQkuaW5kZXgoIjEwIikNCgkJCQkuc2VsZWN0aW9uKCJFWEpPQk4iKQ0KCQkJCS5idWlsZCgpOw0KDQoJCURCQ29udGFpbmVyIGNvbnRhaW5lcjEgPSBxdWVyeTEuZ2V0Q29udGFpbmVyKCk7DQoJCWNvbnRhaW5lcjEuc2V0KCJFWENPTk8iLCBpbnRDb25vKTsNCgkJY29udGFpbmVyMS5zZXQoIkVYSk9CTiIsIGpvYm4pOw0KCQlxdWVyeTEucmVhZEFsbExvY2soY29udGFpbmVyMSwgMiwgZGVsZXRlQ2FsbEJhY2sxKTsNCgl9DQoNCglDbG9zdXJlPD8+IGRlbGV0ZUNhbGxCYWNrMSA9IHsgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdCAtPg0KCQlsb2dnZXIuZGVidWcoIiBkZWxldGUgZGVsZXRlQ2FsbEJhY2sxOiAiICsgbG9ja2VkUmVzdWx0LmdldCgiRVhKT0JOIikpOw0KCQlsb2NrZWRSZXN1bHQuZGVsZXRlKCk7DQoJfQ0KfQ0K"}}}